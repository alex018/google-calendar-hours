{"version":3,"sources":["features/MultiCalendarGraph.module.css","Interface.module.css","AuthScreen.module.css","stores/authentication.js","AuthScreen.js","stores/api.js","stores/calendarEvents.js","stores/calendars.js","stores/storage.js","constants.js","utils/roundHours.js","stores/viewState.js","features/MultiCalendarGraph.js","Interface.js","App.js","stores/index.js","index.js","App.module.css"],"names":["module","exports","authentication","createSlice","name","initialState","reducers","selectAccessToken","state","accessToken","selectHasToken","Boolean","App","className","styles","card","hero","title","subtitle","features","feature","featureIcon","style","background","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","x","y","width","height","rx","ry","x1","y1","x2","y2","featureText","cx","cy","r","points","d","authSection","authLabel","href","params","encode","client_id","redirect_uri","window","location","origin","pathname","replace","scope","response_type","getGoogleAuthUrl","data-testid","authLink","googleIcon","privacy","privacyTitle","privacyText","privacyBadge","fetchGoogle","a","url","fetch","access_token","response","status","sessionStorage","removeItem","Promise","reject","json","fetchCalendars","fetchEvents","calendarId","pageToken","acc","encodeURIComponent","singleEvents","maxResults","timeMax","dayjs","add","toJSON","items","nextPageToken","fetchCalendarEvents","calendarEvents","loadingCount","map","setCalendarEvents","payload","events","setLoading","actions","loadCalendarEvents","dispatch","getState","id","summary","start","end","dateTime","filter","selectIsEventsLoading","selectAllCalendarEventsMap","calendars","list","setCalendars","selectCalendars","updateConfig","rest","existingConfig","JSON","parse","localStorage","getItem","err","updatedConfig","setItem","stringify","getConfig","RANGE_TYPE","WEEK_START","roundHours","number","Math","round","extend","isoWeek","viewState","setSelectedCalendarId","selectedCalendarId","setRangeType","selectedRangeType","changeRange","currentDatePointerStart","subtract","resetRange","startOf","setWeekStart","weekStart","setStart","setEnd","currentDatePointerEnd","computeHoursInRange","hours","forEach","evStart","evEnd","evStartDate","Date","evEndDate","selectAllCalendarsYearlyData","eventsMap","currentYear","year","years","Array","from","length","_","i","result","Object","keys","label","String","toDate","endOf","CHART_TYPE","STACKED","GROUPED","LINE","PIE","TIME_RANGE","WEEKLY","MONTHLY","YEARLY","PADDING","chartHeight","niceMax","rawMax","ceil","pieSlicePath","startAngle","endAngle","innerR","toRad","deg","PI","cos","sin","ix1","iy1","ix2","iy2","largeArc","join","MultiCalendarGraph","useSelector","yearlyData","useState","saved","checkedCalendarIds","isArray","Set","checkedCalendars","setCheckedCalendars","chartType","setChartType","timeRange","setTimeRange","graphYear","setGraphYear","scrollRef","useRef","chartAreaRef","tooltip","setTooltip","touchTimerRef","makeHandlers","text","onMouseEnter","e","rect","current","getBoundingClientRect","clientX","left","clientY","top","onMouseMove","prev","onMouseLeave","onTouchStart","clearTimeout","touch","touches","setTimeout","monthlyData","targetYear","month","padStart","format","selectAllCalendarsMonthlyData","weeklyData","weeksInYear","weekNum","weekEnd","selectAllCalendarsWeeklyData","useEffect","c","allData","pickData","isChecked","has","activeCalendars","periods","yMax","max","total","reduce","sum","cal","getStackedMax","getSingleMax","yTicks","Y_TICKS","isWeekly","periodCount","svgWidth","chartWidth","barSlotWidth","groupedBarWidth","stackedBarWidth","stackedBarOffset","renderYAxis","tick","key","textAnchor","axisLabel","renderXAxis","renderXLabels","skipEvery","p","isPie","isYearly","showYearNav","thisYear","pieSvgHeight","container","calendarList","calendarItem","type","checked","onChange","next","delete","checkbox","colorDot","color","calendarName","loadingBadge","controls","controlGroup","controlLabel","toggle","toggleBtn","active","onClick","disabled","empty","ref","chartArea","chart","aria-label","totals","grandTotal","currentAngle","slices","angle","slice","pct","toFixed","Fragment","s","h","bar","pieCenter","pieCenterSub","ly","lx","legendLabel","legendHours","renderPieChart","chartScroll","scrollable","minWidth","period","periodIdx","yBottom","barH","renderStackedBars","calIdx","renderGroupedBars","calData","line","indexOf","dot","renderLineChart","yearNav","yearNavBtn","yearLabel","Interface","useDispatch","eventsLoading","backgroundColor","interface","loadingBar","initialLoading","spinner","hasToken","hashParams","decode","hash","appWrapper","app","sticky","content","header","headerIcon","xmlns","headline","AuthScreen","footer","target","rel","weekday","getAccessToken","getViewState","config","store","configureStore","reducer","preloadedState","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f65742af.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MultiCalendarGraph_container__2G71p\",\"calendarList\":\"MultiCalendarGraph_calendarList__3jRWa\",\"calendarItem\":\"MultiCalendarGraph_calendarItem__Mk0B2\",\"checkbox\":\"MultiCalendarGraph_checkbox__fsU-E\",\"colorDot\":\"MultiCalendarGraph_colorDot__3_d2y\",\"calendarName\":\"MultiCalendarGraph_calendarName__3nR4m\",\"loadingBadge\":\"MultiCalendarGraph_loadingBadge__3pyf6\",\"controls\":\"MultiCalendarGraph_controls__12q7U\",\"controlGroup\":\"MultiCalendarGraph_controlGroup__1NsfH\",\"controlLabel\":\"MultiCalendarGraph_controlLabel__13Uxl\",\"toggle\":\"MultiCalendarGraph_toggle__db6Z1\",\"toggleBtn\":\"MultiCalendarGraph_toggleBtn__1eNci\",\"active\":\"MultiCalendarGraph_active__32ScX\",\"chartArea\":\"MultiCalendarGraph_chartArea__3eHSZ\",\"chartScroll\":\"MultiCalendarGraph_chartScroll__2GeQ4\",\"tooltip\":\"MultiCalendarGraph_tooltip__3UB_9\",\"scrollable\":\"MultiCalendarGraph_scrollable__2kvc2\",\"chart\":\"MultiCalendarGraph_chart__16vJK\",\"bar\":\"MultiCalendarGraph_bar__2K_Z1\",\"line\":\"MultiCalendarGraph_line__BF4qH\",\"dot\":\"MultiCalendarGraph_dot__2QBOC\",\"axisLabel\":\"MultiCalendarGraph_axisLabel__3nRHM\",\"barLabel\":\"MultiCalendarGraph_barLabel__3qVhH\",\"pieCenter\":\"MultiCalendarGraph_pieCenter__Vmksl\",\"pieCenterSub\":\"MultiCalendarGraph_pieCenterSub__tPuQY\",\"legendLabel\":\"MultiCalendarGraph_legendLabel__3-Ve4\",\"legendHours\":\"MultiCalendarGraph_legendHours__3JWVK\",\"empty\":\"MultiCalendarGraph_empty__BB_rg\",\"yearNav\":\"MultiCalendarGraph_yearNav__2g12i\",\"yearNavBtn\":\"MultiCalendarGraph_yearNavBtn__1OfHP\",\"yearLabel\":\"MultiCalendarGraph_yearLabel__2KRlj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"interface\":\"Interface_interface__1pJyE\",\"loadingBar\":\"Interface_loadingBar__1Nzqm\",\"spin\":\"Interface_spin__2LMD4\",\"initialLoading\":\"Interface_initialLoading__3lQaJ\",\"spinner\":\"Interface_spinner__285RU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"AuthScreen_card__3YR00\",\"hero\":\"AuthScreen_hero__2XAwP\",\"title\":\"AuthScreen_title__38rD0\",\"subtitle\":\"AuthScreen_subtitle__1M1yo\",\"features\":\"AuthScreen_features__1NgF_\",\"feature\":\"AuthScreen_feature__d_mRb\",\"featureIcon\":\"AuthScreen_featureIcon__2tbRP\",\"featureText\":\"AuthScreen_featureText__3Wcju\",\"authSection\":\"AuthScreen_authSection__Vjgrz\",\"authLabel\":\"AuthScreen_authLabel__l_Osn\",\"authLink\":\"AuthScreen_authLink__2qdja\",\"googleIcon\":\"AuthScreen_googleIcon__14q1_\",\"privacy\":\"AuthScreen_privacy__1JsHl\",\"privacyTitle\":\"AuthScreen_privacyTitle__3szyP\",\"privacyText\":\"AuthScreen_privacyText__UT3lV\",\"privacyBadge\":\"AuthScreen_privacyBadge__2zVRb\"};","import { createSlice } from '@reduxjs/toolkit';\n\nexport const authentication = createSlice({\n  name: 'authentication',\n  initialState: null,\n  reducers: {},\n});\n\nexport const selectAccessToken = (state) => state.authentication.accessToken;\nexport const selectHasToken = (state) => Boolean(selectAccessToken(state));\n\nexport default authentication.reducer;\n","import React from 'react';\nimport { encode } from 'qss';\n\nimport styles from './AuthScreen.module.css';\n\nconst googleClientId = '386288482739-qv303lmckdqrmksk8mqpihpfu4o8kc7k.apps.googleusercontent.com';\nconst googleScope =\n  'https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events.readonly';\n\nconst App = () => {\n  const getGoogleAuthUrl = () => {\n    const params = encode({\n      client_id: googleClientId,\n      redirect_uri: window.location.origin + window.location.pathname.replace(/\\/$/, ''),\n      scope: googleScope,\n      response_type: 'token',\n    });\n\n    return `https://accounts.google.com/o/oauth2/auth?${params}`;\n  };\n\n  return (\n    <div className={styles.card}>\n      <div className={styles.hero}>\n        <h2 className={styles.title}>Track your calendar hours</h2>\n        <p className={styles.subtitle}>\n          Connect your Google Calendar to see how you spend your time.\n          Filter by day, week, month, year, or custom range.\n        </p>\n      </div>\n\n      <div className={styles.features}>\n        <div className={styles.feature}>\n          <div className={styles.featureIcon} style={{ background: '#eff6ff' }}>\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#3b82f6\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n              <line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\" />\n              <line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\" />\n              <line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\" />\n            </svg>\n          </div>\n          <span className={styles.featureText}>Multi-calendar support</span>\n        </div>\n        <div className={styles.feature}>\n          <div className={styles.featureIcon} style={{ background: '#f0fdf4' }}>\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#22c55e\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <line x1=\"18\" y1=\"20\" x2=\"18\" y2=\"10\" />\n              <line x1=\"12\" y1=\"20\" x2=\"12\" y2=\"4\" />\n              <line x1=\"6\" y1=\"20\" x2=\"6\" y2=\"14\" />\n            </svg>\n          </div>\n          <span className={styles.featureText}>Visual charts and graphs</span>\n        </div>\n        <div className={styles.feature}>\n          <div className={styles.featureIcon} style={{ background: '#fef3c7' }}>\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#f59e0b\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\" />\n              <polyline points=\"12 6 12 12 16 14\" />\n            </svg>\n          </div>\n          <span className={styles.featureText}>Flexible time ranges</span>\n        </div>\n        <div className={styles.feature}>\n          <div className={styles.featureIcon} style={{ background: '#fae8ff' }}>\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#c026d3\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\" />\n            </svg>\n          </div>\n          <span className={styles.featureText}>Private and secure</span>\n        </div>\n      </div>\n\n      <div className={styles.authSection}>\n        <p className={styles.authLabel}>Connect to get started</p>\n        <a href={getGoogleAuthUrl()} data-testid=\"AuthLink\" className={styles.authLink}>\n          <svg className={styles.googleIcon} viewBox=\"0 0 24 24\">\n            <path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z\" fill=\"#4285F4\" />\n            <path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#34A853\" />\n            <path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18A10.96 10.96 0 0 0 1 12c0 1.77.42 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#FBBC05\" />\n            <path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#EA4335\" />\n          </svg>\n          Sign in with Google\n        </a>\n      </div>\n\n      <div className={styles.privacy}>\n        <p className={styles.privacyTitle}>Privacy</p>\n        <p className={styles.privacyText}>\n          All data stays in your browser. No servers, no tracking. Your calendar\n          data is fetched directly from Google and never stored externally.\n          Authentication is cleared when you close the tab.\n        </p>\n        <span className={styles.privacyBadge}>\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" />\n            <polyline points=\"22 4 12 14.01 9 11.01\" />\n          </svg>\n          Read-only access\n        </span>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import { encode } from 'qss';\nimport dayjs from 'dayjs';\n\nconst API_BASE_PATH = 'https://www.googleapis.com/calendar/v3/';\n\nconst fetchGoogle = async ({ url, accessToken, params }) => {\n  const response = await fetch(\n    `${url}?${encode({\n      access_token: accessToken,\n      ...params,\n    })}`\n  );\n\n  if (response.status !== 200) {\n    sessionStorage.removeItem('accessToken');\n    window.location = '/';\n    return Promise.reject();\n  }\n  return response.json();\n};\n\nexport const fetchCalendars = ({ accessToken }) =>\n  fetchGoogle({ url: `${API_BASE_PATH}users/me/calendarList`, accessToken });\n\nconst fetchEvents = async ({ accessToken, calendarId, pageToken, acc }) => {\n  const { items, nextPageToken } = await fetchGoogle({\n    url: `${API_BASE_PATH}calendars/${encodeURIComponent(calendarId)}/events`,\n    accessToken,\n    params: {\n      singleEvents: true,\n      maxResults: 2500,\n      pageToken,\n      timeMax: dayjs().add(2, 'year').toJSON(),\n    },\n  });\n\n  if (!nextPageToken) {\n    return [...acc, ...items];\n  }\n\n  return fetchEvents({\n    accessToken,\n    calendarId,\n    pageToken: nextPageToken,\n    acc: [...acc, ...items],\n  });\n};\n\nexport const fetchCalendarEvents = ({ accessToken, calendarId }) =>\n  fetchEvents({ accessToken, calendarId, acc: [] });\n","import { createSlice } from '@reduxjs/toolkit';\n\nimport { selectAccessToken } from './authentication';\nimport { fetchCalendarEvents } from './api';\n\nexport const calendarEvents = createSlice({\n  name: 'calendarEvents',\n  initialState: {\n    loadingCount: 0,\n    map: {},\n  },\n  reducers: {\n    setCalendarEvents: (state, { payload }) => {\n      state.map[payload.calendarId] = payload.events;\n    },\n    setLoading: (state, { payload }) => {\n      state.loadingCount += payload ? 1 : -1;\n    },\n  },\n});\n\nconst { setCalendarEvents, setLoading } = calendarEvents.actions;\n\nexport const loadCalendarEvents = ({ calendarId }) => async (\n  dispatch,\n  getState\n) => {\n  const accessToken = selectAccessToken(getState());\n  try {\n    dispatch(setLoading(true));\n    const items = await fetchCalendarEvents({ accessToken, calendarId });\n    dispatch(\n      setCalendarEvents({\n        calendarId,\n        events: items\n          .map(({ id, summary, start, end }) => {\n            // Filter out events that have no `dateTime`. Those are full day\n            // events, they only have the field `date`.\n            if (!start.dateTime) {\n              return null;\n            }\n\n            // only return the fields we need\n            return {\n              id,\n              summary,\n              start: start.dateTime,\n              end: end.dateTime,\n            };\n          })\n          .filter(Boolean),\n      })\n    );\n  } catch (e) {\n    // do nothing\n  } finally {\n    dispatch(setLoading(false));\n  }\n};\n\nexport const selectIsEventsLoading = (state) =>\n  (state.calendarEvents?.loadingCount ?? 0) > 0;\n\nexport const selectCalendarEvents = (state, calendarId) =>\n  state.calendarEvents?.map[calendarId] ?? null;\n\nexport const selectAllCalendarEventsMap = (state) =>\n  state.calendarEvents?.map ?? {};\n\nexport default calendarEvents.reducer;\n","import { createSlice } from '@reduxjs/toolkit';\n\nimport { selectAccessToken } from './authentication';\nimport { fetchCalendars } from './api';\nimport { loadCalendarEvents } from './calendarEvents';\n\nexport const calendars = createSlice({\n  name: 'calendars',\n  initialState: {\n    list: null,\n  },\n  reducers: {\n    setCalendars: (state, { payload }) => {\n      state.list = payload;\n    },\n  },\n});\n\nconst { setCalendars } = calendars.actions;\n\nexport const loadCalendars = () => async (dispatch, getState) => {\n  const accessToken = selectAccessToken(getState());\n  try {\n    const { items } = await fetchCalendars({ accessToken });\n    const calendarList = items.map(({ id, summary, backgroundColor }) => ({\n      id,\n      label: summary,\n      color: backgroundColor || '#4285f4',\n    }));\n\n    dispatch(setCalendars(calendarList));\n\n    // Load events for all calendars in parallel\n    calendarList.forEach(({ id }) => {\n      dispatch(loadCalendarEvents({ calendarId: id }));\n    });\n  } catch (e) {\n    // do nothing\n  }\n};\n\nexport const selectCalendars = (state) => state.calendars.list;\n\nexport const selectCalendarColor = (state, calendarId) => {\n  const calendar = state.calendars.list?.find(({ id }) => id === calendarId);\n  return calendar?.color || '#4285f4';\n};\n\nexport default calendars.reducer;\n","export const updateConfig = (rest) => {\n  let existingConfig;\n  try {\n    existingConfig = JSON.parse(window.localStorage.getItem('config'));\n  } catch (err) {\n    // don't handle\n  }\n\n  const updatedConfig = {\n    ...existingConfig,\n    ...rest,\n  };\n\n  window.localStorage.setItem('config', JSON.stringify(updatedConfig));\n};\n\nexport const getConfig = () => {\n  try {\n    return JSON.parse(window.localStorage.getItem('config'));\n  } catch (err) {\n    // don't handle\n  }\n  return null;\n};\n","export const RANGE_TYPE = {\n  DAY: 'day',\n  WEEK: 'week',\n  MONTH: 'month',\n  YEAR: 'year',\n  TOTAL: 'total',\n  CUSTOM: 'custom',\n};\n\nexport const SORT_BY = {\n  DATE: 'date',\n  AMOUNT: 'amount',\n};\n\nexport const WEEK_START = {\n  MONDAY: 'monday',\n  SUNDAY: 'sunday',\n};\n","const roundHours = (number) => Math.round(number * 100) / 100;\n\nexport default roundHours;\n","import { createSlice } from '@reduxjs/toolkit';\nimport dayjs from 'dayjs';\nimport isoWeek from 'dayjs/plugin/isoWeek';\nimport 'dayjs/locale/de';\n\nimport { loadCalendarEvents, selectCalendarEvents, selectAllCalendarEventsMap } from './calendarEvents';\nimport { updateConfig } from './storage';\nimport { RANGE_TYPE, WEEK_START } from '../constants';\nimport roundHours from '../utils/roundHours';\n\ndayjs.extend(isoWeek);\n\nexport const viewState = createSlice({\n  name: 'viewState',\n  initialState: null,\n  reducers: {\n    setSelectedCalendarId: (state, { payload }) => {\n      state.selectedCalendarId = payload;\n    },\n    setRangeType: (state, { payload }) => {\n      state.selectedRangeType = payload;\n    },\n    changeRange: (state, { payload }) => {\n      if (payload === 'prev') {\n        state.currentDatePointerStart = dayjs(state.currentDatePointerStart)\n          .subtract(1, state.selectedRangeType)\n          .toJSON();\n      } else if (payload === 'next') {\n        state.currentDatePointerStart = dayjs(state.currentDatePointerStart)\n          .add(1, state.selectedRangeType)\n          .toJSON();\n      }\n    },\n    resetRange: (state) => {\n      state.currentDatePointerStart = dayjs().startOf('day').toJSON();\n    },\n    setWeekStart: (state, { payload }) => {\n      state.weekStart = payload;\n    },\n    setStart: (state, { payload }) => {\n      state.currentDatePointerStart = payload;\n    },\n    setEnd: (state, { payload }) => {\n      state.currentDatePointerEnd = payload;\n    },\n  },\n});\n\nexport const { changeRange, resetRange } = viewState.actions;\nconst {\n  setSelectedCalendarId,\n  setRangeType,\n  setWeekStart,\n  setStart,\n  setEnd,\n} = viewState.actions;\n\nexport const selectSelectedCalendar = (state) =>\n  state.viewState.selectedCalendarId;\n\nexport const selectDate = (state) => state.viewState.currentDatePointerStart;\n\nexport const selectRangeType = (state) => state.viewState.selectedRangeType;\nexport const selectWeekStart = (state) => state.viewState.weekStart;\nexport const selectLocaleForWeekStart = (state) =>\n  state.viewState.weekStart === WEEK_START.SUNDAY ? 'en' : 'de';\n\nexport const selectCurrentDatePointers = (state) => {\n  const {\n    selectedRangeType,\n    currentDatePointerStart,\n    currentDatePointerEnd,\n  } = state.viewState;\n  const currentDatePointerStartDate = dayjs(currentDatePointerStart);\n\n  if (selectedRangeType === RANGE_TYPE.CUSTOM) {\n    return {\n      start: dayjs(currentDatePointerStart),\n      // The selected end day should be included in the calculation, so we\n      // need to add an extra day.\n      end: dayjs(currentDatePointerEnd).add(1, 'day'),\n    };\n  }\n\n  let rangeStart;\n  let rangeEnd;\n\n  if (selectedRangeType === RANGE_TYPE.DAY) {\n    rangeStart = currentDatePointerStartDate.startOf('day');\n    rangeEnd = rangeStart.add(1, 'day');\n  } else if (selectedRangeType === RANGE_TYPE.WEEK) {\n    rangeStart = currentDatePointerStartDate\n      .locale(selectLocaleForWeekStart(state))\n      .startOf('day')\n      .weekday(0);\n    rangeEnd = rangeStart.add(1, 'week');\n  } else if (selectedRangeType === RANGE_TYPE.MONTH) {\n    rangeStart = currentDatePointerStartDate.startOf('month');\n    rangeEnd = rangeStart.add(1, 'month');\n  } else if (selectedRangeType === RANGE_TYPE.YEAR) {\n    rangeStart = currentDatePointerStartDate.startOf('year');\n    rangeEnd = rangeStart.add(1, 'year');\n  } else if (selectedRangeType === RANGE_TYPE.TOTAL) {\n    rangeStart = dayjs('2000-01-01T10:00:00Z');\n    rangeEnd = dayjs('2040-01-01T10:00:00Z');\n  }\n\n  return {\n    start: rangeStart,\n    end: rangeEnd,\n  };\n};\n\nexport const selectEventsByRange = (state) => {\n  const events = selectCalendarEvents(state, selectSelectedCalendar(state));\n\n  if (!events) {\n    return null;\n  }\n\n  const { start: rangeStart, end: rangeEnd } = selectCurrentDatePointers(state);\n\n  return events\n    .filter(\n      ({ start, end }) =>\n        // Filter out all events that end before selected start date or start after\n        // selected end date.\n        !(new Date(end) < rangeStart || new Date(start) > rangeEnd)\n    )\n    .map(({ start, end, ...rest }) => ({\n      ...rest,\n      start: new Date(start) < rangeStart ? rangeStart.toJSON() : start,\n      end: new Date(end) > rangeEnd ? rangeEnd.toJSON() : end,\n    }));\n};\n\nexport const selectHours = (state) => {\n  const events = selectEventsByRange(state);\n\n  if (!events) {\n    return null;\n  }\n\n  let hours = 0;\n\n  events.forEach(({ start, end }) => {\n    hours += (new Date(end) - new Date(start)) / 1000 / 60 / 60;\n  });\n\n  return roundHours(hours);\n};\n\nexport const selectNumberOfEvents = (state) =>\n  selectEventsByRange(state)?.length || 0;\n\nconst computeHoursInRange = (events, start, end) => {\n  let hours = 0;\n  events.forEach(({ start: evStart, end: evEnd }) => {\n    const evStartDate = new Date(evStart);\n    const evEndDate = new Date(evEnd);\n    if (evEndDate <= start || evStartDate >= end) return;\n    const clippedStart = evStartDate < start ? start : evStartDate;\n    const clippedEnd = evEndDate > end ? end : evEndDate;\n    hours += (clippedEnd - clippedStart) / 1000 / 60 / 60;\n  });\n  return roundHours(hours);\n};\n\nexport const selectMonthlyGraphData = (state) => {\n  const events = selectCalendarEvents(state, selectSelectedCalendar(state));\n  if (!events) return null;\n\n  const year = dayjs(state.viewState.currentDatePointerStart).year();\n\n  return Array.from({ length: 12 }, (_, month) => {\n    const start = dayjs(`${year}-${String(month + 1).padStart(2, '0')}-01`)\n      .startOf('month')\n      .toDate();\n    const end = dayjs(`${year}-${String(month + 1).padStart(2, '0')}-01`)\n      .endOf('month')\n      .add(1, 'millisecond')\n      .toDate();\n    return {\n      label: dayjs(`${year}-${String(month + 1).padStart(2, '0')}-01`).format(\n        'MMM'\n      ),\n      hours: computeHoursInRange(events, start, end),\n    };\n  });\n};\n\nexport const selectYearlyGraphData = (state) => {\n  const events = selectCalendarEvents(state, selectSelectedCalendar(state));\n  if (!events) return null;\n\n  const currentYear = dayjs().year();\n  const years = Array.from({ length: 5 }, (_, i) => currentYear - 4 + i);\n\n  return years.map((year) => {\n    const start = dayjs(`${year}-01-01`).startOf('year').toDate();\n    const end = dayjs(`${year}-12-31`).endOf('year').add(1, 'millisecond').toDate();\n    return {\n      label: String(year),\n      hours: computeHoursInRange(events, start, end),\n    };\n  });\n};\n\nexport const selectAllCalendarsMonthlyData = (state, year) => {\n  const eventsMap = selectAllCalendarEventsMap(state);\n  const targetYear = year || dayjs().year();\n\n  const result = {};\n  Object.keys(eventsMap).forEach((calendarId) => {\n    const events = eventsMap[calendarId];\n    if (!events) return;\n    result[calendarId] = Array.from({ length: 12 }, (_, month) => {\n      const d = dayjs(`${targetYear}-${String(month + 1).padStart(2, '0')}-01`);\n      return {\n        label: d.format('MMM'),\n        hours: computeHoursInRange(\n          events,\n          d.startOf('month').toDate(),\n          d.endOf('month').add(1, 'millisecond').toDate()\n        ),\n      };\n    });\n  });\n  return result;\n};\n\nexport const selectAllCalendarsYearlyData = (state) => {\n  const eventsMap = selectAllCalendarEventsMap(state);\n  const currentYear = dayjs().year();\n  const years = Array.from({ length: 5 }, (_, i) => currentYear - 4 + i);\n\n  const result = {};\n  Object.keys(eventsMap).forEach((calendarId) => {\n    const events = eventsMap[calendarId];\n    if (!events) return;\n    result[calendarId] = years.map((year) => ({\n      label: String(year),\n      hours: computeHoursInRange(\n        events,\n        dayjs(`${year}-01-01`).startOf('year').toDate(),\n        dayjs(`${year}-12-31`).endOf('year').add(1, 'millisecond').toDate()\n      ),\n    }));\n  });\n  return result;\n};\n\nexport const selectAllCalendarsWeeklyData = (state, year) => {\n  const eventsMap = selectAllCalendarEventsMap(state);\n  const currentYear = year || dayjs().year();\n  // Determine number of ISO weeks in the current year\n  const weeksInYear = dayjs(`${currentYear}-12-28`).isoWeek();\n\n  const result = {};\n  Object.keys(eventsMap).forEach((calendarId) => {\n    const events = eventsMap[calendarId];\n    if (!events) return;\n    result[calendarId] = Array.from({ length: weeksInYear }, (_, i) => {\n      const weekNum = i + 1;\n      const weekStart = dayjs()\n        .year(currentYear)\n        .isoWeek(weekNum)\n        .startOf('isoWeek')\n        .toDate();\n      const weekEnd = dayjs()\n        .year(currentYear)\n        .isoWeek(weekNum)\n        .endOf('isoWeek')\n        .add(1, 'millisecond')\n        .toDate();\n      return {\n        label: `W${weekNum}`,\n        hours: computeHoursInRange(events, weekStart, weekEnd),\n      };\n    });\n  });\n  return result;\n};\n\nexport const setSelectedCalendar = ({ calendarId }) => (dispatch, getState) => {\n  dispatch(setSelectedCalendarId(calendarId));\n  updateConfig({ selectedCalendarId: calendarId });\n  const calendarEvents = selectCalendarEvents(getState(), calendarId);\n  if (!calendarEvents) {\n    dispatch(loadCalendarEvents({ calendarId }));\n  }\n};\n\nexport const changeRangeType = ({ range }) => (dispatch, getState) => {\n  if (range === RANGE_TYPE.CUSTOM) {\n    const { start, end } = selectCurrentDatePointers(getState());\n    // We need to subtract a day here, because a day was added to `end`\n    // in order to have the selected end day in the calculation.\n    const correctedEnd = end.subtract(1, 'day');\n    dispatch(setStart(start.toJSON()));\n    dispatch(setEnd(correctedEnd.toJSON()));\n    updateConfig({ start: start.toJSON(), end: correctedEnd.toJSON() });\n  }\n  dispatch(setRangeType(range));\n  updateConfig({ selectedRangeType: range });\n};\n\nexport const changeWeekStart = (weekStart) => (dispatch) => {\n  dispatch(setWeekStart(weekStart));\n  updateConfig({ weekStart });\n};\n\nexport const changeStart = (start) => (dispatch) => {\n  dispatch(setStart(start));\n  updateConfig({ start });\n};\n\nexport const changeEnd = (end) => (dispatch) => {\n  dispatch(setEnd(end));\n  updateConfig({ end });\n};\n\nexport default viewState.reducer;\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport dayjs from 'dayjs';\n\nimport { selectCalendars } from '../stores/calendars';\nimport {\n  selectAllCalendarsMonthlyData,\n  selectAllCalendarsYearlyData,\n  selectAllCalendarsWeeklyData,\n} from '../stores/viewState';\nimport { getConfig, updateConfig } from '../stores/storage';\n\nimport styles from './MultiCalendarGraph.module.css';\n\nconst CHART_TYPE = {\n  STACKED: 'stacked',\n  GROUPED: 'grouped',\n  LINE: 'line',\n  PIE: 'pie',\n};\n\nconst TIME_RANGE = {\n  WEEKLY: 'weekly',\n  MONTHLY: 'monthly',\n  YEARLY: 'yearly',\n};\n\nconst BAR_CHART_HEIGHT = 320;\nconst PADDING = { top: 28, right: 16, bottom: 40, left: 52 };\nconst Y_TICKS = 4;\n\nconst chartHeight = BAR_CHART_HEIGHT - PADDING.top - PADDING.bottom;\n\nfunction niceMax(rawMax) {\n  if (!rawMax || rawMax === 0) return Y_TICKS;\n  return Math.ceil(rawMax / Y_TICKS) * Y_TICKS;\n}\n\nfunction pickData(timeRange, weeklyData, monthlyData, yearlyData) {\n  if (timeRange === TIME_RANGE.WEEKLY) return weeklyData;\n  if (timeRange === TIME_RANGE.MONTHLY) return monthlyData;\n  return yearlyData;\n}\n\n// Compute pie arc path\nfunction pieSlicePath(cx, cy, r, startAngle, endAngle, innerR) {\n  const toRad = (deg) => (deg * Math.PI) / 180;\n  const x1 = cx + r * Math.cos(toRad(startAngle));\n  const y1 = cy + r * Math.sin(toRad(startAngle));\n  const x2 = cx + r * Math.cos(toRad(endAngle));\n  const y2 = cy + r * Math.sin(toRad(endAngle));\n  const ix1 = cx + innerR * Math.cos(toRad(endAngle));\n  const iy1 = cy + innerR * Math.sin(toRad(endAngle));\n  const ix2 = cx + innerR * Math.cos(toRad(startAngle));\n  const iy2 = cy + innerR * Math.sin(toRad(startAngle));\n  const largeArc = endAngle - startAngle > 180 ? 1 : 0;\n  return [\n    `M ${x1} ${y1}`,\n    `A ${r} ${r} 0 ${largeArc} 1 ${x2} ${y2}`,\n    `L ${ix1} ${iy1}`,\n    `A ${innerR} ${innerR} 0 ${largeArc} 0 ${ix2} ${iy2}`,\n    'Z',\n  ].join(' ');\n}\n\nconst MultiCalendarGraph = () => {\n  const calendars = useSelector(selectCalendars);\n  const yearlyData = useSelector(selectAllCalendarsYearlyData);\n\n  // null = not yet initialised (waiting for calendar list to arrive)\n  // Set  = explicit selection (including empty Set = all unchecked)\n  const [checkedCalendars, setCheckedCalendars] = useState(() => {\n    const saved = getConfig()?.checkedCalendarIds;\n    return Array.isArray(saved) ? new Set(saved) : null;\n  });\n  const [chartType, setChartType] = useState(CHART_TYPE.STACKED);\n  const [timeRange, setTimeRange] = useState(TIME_RANGE.MONTHLY);\n  const [graphYear, setGraphYear] = useState(dayjs().year());\n  const scrollRef = useRef(null);\n  const chartAreaRef = useRef(null);\n  const [tooltip, setTooltip] = useState(null); // { x, y, text } | null\n  const touchTimerRef = useRef(null);\n\n  const makeHandlers = (text) => ({\n    onMouseEnter(e) {\n      const rect = chartAreaRef.current?.getBoundingClientRect();\n      if (!rect) return;\n      setTooltip({ x: e.clientX - rect.left, y: e.clientY - rect.top, text });\n    },\n    onMouseMove(e) {\n      const rect = chartAreaRef.current?.getBoundingClientRect();\n      if (!rect) return;\n      setTooltip((prev) =>\n        prev ? { ...prev, x: e.clientX - rect.left, y: e.clientY - rect.top } : prev\n      );\n    },\n    onMouseLeave() {\n      setTooltip(null);\n    },\n    onTouchStart(e) {\n      clearTimeout(touchTimerRef.current);\n      const touch = e.touches[0];\n      const rect = chartAreaRef.current?.getBoundingClientRect();\n      if (!rect) return;\n      setTooltip({ x: touch.clientX - rect.left, y: touch.clientY - rect.top, text });\n      touchTimerRef.current = setTimeout(() => setTooltip(null), 2500);\n    },\n  });\n\n  // These selectors re-run whenever graphYear changes\n  const monthlyData = useSelector((state) => selectAllCalendarsMonthlyData(state, graphYear));\n  const weeklyData = useSelector((state) => selectAllCalendarsWeeklyData(state, graphYear));\n\n  // First-time init: no saved selection  default to all calendars checked\n  useEffect(() => {\n    if (calendars && checkedCalendars === null) {\n      setCheckedCalendars(new Set(calendars.map((c) => c.id)));\n    }\n  }, [calendars, checkedCalendars]);\n\n  const toggleCalendar = (calendarId) => {\n    setCheckedCalendars((prev) => {\n      const next = new Set(prev);\n      if (next.has(calendarId)) {\n        next.delete(calendarId);\n      } else {\n        next.add(calendarId);\n      }\n      updateConfig({ checkedCalendarIds: [...next] });\n      return next;\n    });\n  };\n\n  // Pick the right data set based on timeRange\n  const allData = pickData(timeRange, weeklyData, monthlyData, yearlyData);\n\n  // While null (waiting for first calendar list), treat everything as checked\n  const isChecked = (id) => checkedCalendars === null || checkedCalendars.has(id);\n\n  // Active calendars = those that are checked AND have data loaded\n  const activeCalendars = (calendars || []).filter(\n    (c) => isChecked(c.id) && allData[c.id]\n  );\n\n  // Get period labels from the first active calendar's data, or empty\n  const firstData = activeCalendars.length > 0 ? allData[activeCalendars[0].id] : [];\n  const periods = firstData || [];\n\n  // ---- Y-axis helpers ----\n  const getStackedMax = () => {\n    if (periods.length === 0) return Y_TICKS;\n    let max = 0;\n    periods.forEach((_, i) => {\n      const total = activeCalendars.reduce(\n        (sum, cal) => sum + (allData[cal.id]?.[i]?.hours || 0),\n        0\n      );\n      if (total > max) max = total;\n    });\n    return niceMax(max);\n  };\n\n  const getSingleMax = () => {\n    let max = 0;\n    activeCalendars.forEach((cal) => {\n      (allData[cal.id] || []).forEach(({ hours }) => {\n        if (hours > max) max = hours;\n      });\n    });\n    return niceMax(max);\n  };\n\n  const yMax =\n    chartType === CHART_TYPE.STACKED ? getStackedMax() : getSingleMax();\n  const yTicks = Array.from({ length: Y_TICKS + 1 }, (_, i) =>\n    Math.round((yMax / Y_TICKS) * i)\n  );\n\n  // ---- SVG dimensions ----\n  const isWeekly = timeRange === TIME_RANGE.WEEKLY;\n  const periodCount = periods.length || 1;\n\n  // For weekly: wider SVG inside scrollable container\n  const svgWidth = isWeekly\n    ? Math.max(560, periodCount * 22 + PADDING.left + PADDING.right)\n    : 560;\n  const chartWidth = svgWidth - PADDING.left - PADDING.right;\n\n  // Bar sizing\n  const barSlotWidth = chartWidth / Math.max(periodCount, 1);\n  const groupedBarWidth =\n    activeCalendars.length > 0\n      ? (barSlotWidth * 0.8) / activeCalendars.length\n      : barSlotWidth * 0.6;\n  const stackedBarWidth = barSlotWidth * 0.6;\n  const stackedBarOffset = barSlotWidth * 0.2;\n\n  // ---- Chart rendering functions ----\n\n  const renderYAxis = () =>\n    yTicks.map((tick) => {\n      const y = PADDING.top + chartHeight - (tick / yMax) * chartHeight;\n      return (\n        <g key={tick}>\n          <line\n            x1={PADDING.left}\n            y1={y}\n            x2={PADDING.left + chartWidth}\n            y2={y}\n            stroke=\"#e2e8f0\"\n            strokeWidth=\"1\"\n          />\n          <text\n            x={PADDING.left - 6}\n            y={y + 4}\n            textAnchor=\"end\"\n            className={styles.axisLabel}\n          >\n            {tick}h\n          </text>\n        </g>\n      );\n    });\n\n  const renderXAxis = () => (\n    <line\n      x1={PADDING.left}\n      y1={PADDING.top + chartHeight}\n      x2={PADDING.left + chartWidth}\n      y2={PADDING.top + chartHeight}\n      stroke=\"#cbd5e1\"\n      strokeWidth=\"1\"\n    />\n  );\n\n  const renderXLabels = (skipEvery = 1) =>\n    periods.map((p, i) => {\n      if (i % skipEvery !== 0) return null;\n      const x = PADDING.left + i * barSlotWidth + barSlotWidth / 2;\n      return (\n        <text\n          key={p.label}\n          x={x}\n          y={PADDING.top + chartHeight + 16}\n          textAnchor=\"middle\"\n          className={styles.axisLabel}\n        >\n          {p.label}\n        </text>\n      );\n    });\n\n  const renderStackedBars = () => {\n    const skipEvery = isWeekly ? 4 : 1;\n    return (\n      <React.Fragment>\n        {renderYAxis()}\n        {renderXAxis()}\n        {renderXLabels(skipEvery)}\n        {periods.map((period, periodIdx) => {\n          const x =\n            PADDING.left + periodIdx * barSlotWidth + stackedBarOffset;\n          let yBottom = PADDING.top + chartHeight;\n\n          return (\n            <g key={period.label}>\n              {activeCalendars.map((cal) => {\n                const hours = allData[cal.id]?.[periodIdx]?.hours || 0;\n                if (hours === 0) return null;\n                const barH = (hours / yMax) * chartHeight;\n                const y = yBottom - barH;\n                yBottom = y;\n                const h = makeHandlers(`${cal.label}  ${period.label}: ${hours}h`);\n                return (\n                  <rect\n                    key={cal.id}\n                    x={x}\n                    y={y}\n                    width={stackedBarWidth}\n                    height={barH}\n                    fill={cal.color}\n                    rx=\"3\"\n                    className={styles.bar}\n                    onMouseEnter={h.onMouseEnter}\n                    onMouseMove={h.onMouseMove}\n                    onMouseLeave={h.onMouseLeave}\n                    onTouchStart={h.onTouchStart}\n                  />\n                );\n              })}\n            </g>\n          );\n        })}\n      </React.Fragment>\n    );\n  };\n\n  const renderGroupedBars = () => {\n    const skipEvery = isWeekly ? 4 : 1;\n    return (\n      <React.Fragment>\n        {renderYAxis()}\n        {renderXAxis()}\n        {renderXLabels(skipEvery)}\n        {periods.map((period, periodIdx) => (\n          <g key={period.label}>\n            {activeCalendars.map((cal, calIdx) => {\n              const hours = allData[cal.id]?.[periodIdx]?.hours || 0;\n              const barH = Math.max((hours / yMax) * chartHeight, hours > 0 ? 1 : 0);\n              const x =\n                PADDING.left +\n                periodIdx * barSlotWidth +\n                barSlotWidth * 0.1 +\n                calIdx * groupedBarWidth;\n              const y = PADDING.top + chartHeight - barH;\n              const h = makeHandlers(`${cal.label}  ${period.label}: ${hours}h`);\n              return (\n                <rect\n                  key={cal.id}\n                  x={x}\n                  y={y}\n                  width={Math.max(groupedBarWidth - 1, 1)}\n                  height={barH}\n                  fill={cal.color}\n                  rx=\"3\"\n                  className={styles.bar}\n                  onMouseEnter={h.onMouseEnter}\n                  onMouseMove={h.onMouseMove}\n                  onMouseLeave={h.onMouseLeave}\n                  onTouchStart={h.onTouchStart}\n                />\n              );\n            })}\n          </g>\n        ))}\n      </React.Fragment>\n    );\n  };\n\n  const renderLineChart = () => {\n    const skipEvery = isWeekly ? 4 : 1;\n    return (\n      <React.Fragment>\n        {renderYAxis()}\n        {renderXAxis()}\n        {renderXLabels(skipEvery)}\n        {activeCalendars.map((cal) => {\n          const calData = allData[cal.id] || [];\n          const points = calData\n            .map((d, i) => {\n              const x = PADDING.left + i * barSlotWidth + barSlotWidth / 2;\n              const y =\n                PADDING.top + chartHeight - (d.hours / yMax) * chartHeight;\n              return `${x},${y}`;\n            })\n            .join(' ');\n\n          return (\n            <g key={cal.id}>\n              <polyline\n                points={points}\n                fill=\"none\"\n                stroke={cal.color}\n                strokeWidth=\"2\"\n                strokeLinejoin=\"round\"\n                strokeLinecap=\"round\"\n                className={styles.line}\n              />\n              {calData.map((d) => {\n                if (d.hours === 0) return null;\n                const x = PADDING.left + calData.indexOf(d) * barSlotWidth + barSlotWidth / 2;\n                const y =\n                  PADDING.top + chartHeight - (d.hours / yMax) * chartHeight;\n                const h = makeHandlers(`${cal.label}  ${d.label}: ${d.hours}h`);\n                return (\n                  <circle\n                    key={d.label}\n                    cx={x}\n                    cy={y}\n                    r=\"3\"\n                    fill={cal.color}\n                    className={styles.dot}\n                    onMouseEnter={h.onMouseEnter}\n                    onMouseMove={h.onMouseMove}\n                    onMouseLeave={h.onMouseLeave}\n                    onTouchStart={h.onTouchStart}\n                  />\n                );\n              })}\n            </g>\n          );\n        })}\n      </React.Fragment>\n    );\n  };\n\n  const renderPieChart = () => {\n    // Sum total hours per calendar across all periods\n    const totals = activeCalendars.map((cal) => {\n      const total = (allData[cal.id] || []).reduce(\n        (sum, d) => sum + d.hours,\n        0\n      );\n      return { ...cal, total };\n    });\n    const grandTotal = totals.reduce((sum, c) => sum + c.total, 0);\n\n    if (grandTotal === 0) {\n      return (\n        <text x=\"280\" y=\"120\" textAnchor=\"middle\" className={styles.axisLabel}>\n          No data\n        </text>\n      );\n    }\n\n    const cx = 180;\n    const cy = 110;\n    const r = 90;\n    const innerR = 48;\n\n    let currentAngle = -90;\n    const slices = totals\n      .filter((c) => c.total > 0)\n      .map((cal) => {\n        const angle = (cal.total / grandTotal) * 360;\n        const slice = {\n          ...cal,\n          startAngle: currentAngle,\n          endAngle: currentAngle + angle,\n          pct: ((cal.total / grandTotal) * 100).toFixed(1),\n        };\n        currentAngle += angle;\n        return slice;\n      });\n\n    return (\n      <React.Fragment>\n        {slices.map((s) => {\n          const h = makeHandlers(`${s.label}: ${s.total.toFixed(1)}h (${s.pct}%)`);\n          return (\n            <path\n              key={s.id}\n              d={pieSlicePath(cx, cy, r, s.startAngle, s.endAngle, innerR)}\n              fill={s.color}\n              stroke=\"#fff\"\n              strokeWidth=\"2\"\n              className={styles.bar}\n              onMouseEnter={h.onMouseEnter}\n              onMouseMove={h.onMouseMove}\n              onMouseLeave={h.onMouseLeave}\n              onTouchStart={h.onTouchStart}\n            />\n          );\n        })}\n        {/* Center label */}\n        <text x={cx} y={cy - 6} textAnchor=\"middle\" className={styles.pieCenter}>\n          {grandTotal.toFixed(0)}h\n        </text>\n        <text x={cx} y={cy + 12} textAnchor=\"middle\" className={styles.pieCenterSub}>\n          total\n        </text>\n        {/* Legend */}\n        {slices.map((s, i) => {\n          const lx = 290;\n          const ly = 40 + i * 22;\n          return (\n            <g key={s.id}>\n              <rect x={lx} y={ly} width={12} height={12} fill={s.color} rx=\"2\" />\n              <text x={lx + 18} y={ly + 10} className={styles.legendLabel}>\n                {s.label}\n              </text>\n              <text x={lx + 230} y={ly + 10} textAnchor=\"end\" className={styles.legendHours}>\n                {s.total.toFixed(1)}h ({s.pct}%)\n              </text>\n            </g>\n          );\n        })}\n      </React.Fragment>\n    );\n  };\n\n  const isPie = chartType === CHART_TYPE.PIE;\n  const isYearly = timeRange === TIME_RANGE.YEARLY;\n  const showYearNav = !isPie && !isYearly;\n  const thisYear = dayjs().year();\n  const pieSvgWidth = 540;\n  const pieSvgHeight = Math.max(240, activeCalendars.length * 22 + 80);\n\n  const renderChart = () => {\n    if (activeCalendars.length === 0) {\n      return (\n        <div className={styles.empty}>\n          Select at least one calendar to show the chart.\n        </div>\n      );\n    }\n    if (isPie) {\n      return (\n        <div ref={chartAreaRef} className={styles.chartArea}>\n          <svg\n            className={styles.chart}\n            viewBox={`0 0 ${pieSvgWidth} ${pieSvgHeight}`}\n            aria-label=\"Pie chart: time per calendar\"\n          >\n            {renderPieChart()}\n          </svg>\n          {tooltip && (\n            <div\n              className={styles.tooltip}\n              style={{ left: tooltip.x, top: tooltip.y }}\n            >\n              {tooltip.text}\n            </div>\n          )}\n        </div>\n      );\n    }\n    return (\n      <div ref={chartAreaRef} className={styles.chartArea}>\n        <div\n          className={`${styles.chartScroll} ${isWeekly ? styles.scrollable : ''}`}\n          ref={scrollRef}\n        >\n          <svg\n            className={styles.chart}\n            viewBox={`0 0 ${svgWidth} ${BAR_CHART_HEIGHT}`}\n            style={isWeekly ? { minWidth: svgWidth } : {}}\n            aria-label={`${chartType} ${timeRange} hours chart`}\n          >\n            {chartType === CHART_TYPE.STACKED && renderStackedBars()}\n            {chartType === CHART_TYPE.GROUPED && renderGroupedBars()}\n            {chartType === CHART_TYPE.LINE && renderLineChart()}\n          </svg>\n        </div>\n        {tooltip && (\n          <div\n            className={styles.tooltip}\n            style={{ left: tooltip.x, top: tooltip.y }}\n          >\n            {tooltip.text}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <div className={styles.container}>\n      {/* Calendar checkboxes */}\n      <div className={styles.calendarList}>\n        {(calendars || []).map((cal) => (\n          <label key={cal.id} className={styles.calendarItem}>\n            <input\n              type=\"checkbox\"\n              checked={isChecked(cal.id)}\n              onChange={() => toggleCalendar(cal.id)}\n              className={styles.checkbox}\n            />\n            <span\n              className={styles.colorDot}\n              style={{ background: cal.color }}\n            />\n            <span className={styles.calendarName} title={cal.label}>{cal.label}</span>\n            {!allData[cal.id] && (\n              <span className={styles.loadingBadge}>loading</span>\n            )}\n          </label>\n        ))}\n      </div>\n\n      {/* Controls row */}\n      <div className={styles.controls}>\n        <div className={styles.controlGroup}>\n          <span className={styles.controlLabel}>Chart</span>\n          <div className={styles.toggle}>\n            {[\n              { key: CHART_TYPE.STACKED, label: 'Stacked' },\n              { key: CHART_TYPE.GROUPED, label: 'Grouped' },\n              { key: CHART_TYPE.LINE, label: 'Line' },\n              { key: CHART_TYPE.PIE, label: 'Pie' },\n            ].map(({ key, label }) => (\n              <button\n                key={key}\n                type=\"button\"\n                className={`${styles.toggleBtn} ${chartType === key ? styles.active : ''}`}\n                onClick={() => setChartType(key)}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div className={styles.controlGroup}>\n          <span className={styles.controlLabel}>Period</span>\n          <div className={styles.toggle}>\n            {[\n              { key: TIME_RANGE.WEEKLY, label: 'Weekly' },\n              { key: TIME_RANGE.MONTHLY, label: 'Monthly' },\n              { key: TIME_RANGE.YEARLY, label: 'Yearly' },\n            ].map(({ key, label }) => (\n              <button\n                key={key}\n                type=\"button\"\n                className={`${styles.toggleBtn} ${timeRange === key ? styles.active : ''}`}\n                onClick={() => setTimeRange(key)}\n                disabled={isPie}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Chart */}\n      {renderChart()}\n\n      {/* Year navigation  shown for weekly and monthly views */}\n      {showYearNav && (\n        <div className={styles.yearNav}>\n          <button\n            type=\"button\"\n            className={styles.yearNavBtn}\n            onClick={() => setGraphYear((y) => y - 1)}\n            aria-label=\"Previous year\"\n          >\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polyline points=\"15 18 9 12 15 6\" /></svg>\n          </button>\n          <span className={styles.yearLabel}>{graphYear}</span>\n          <button\n            type=\"button\"\n            className={styles.yearNavBtn}\n            onClick={() => setGraphYear((y) => y + 1)}\n            disabled={graphYear >= thisYear}\n            aria-label=\"Next year\"\n          >\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polyline points=\"9 18 15 12 9 6\" /></svg>\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MultiCalendarGraph;\n","import React, { useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport MultiCalendarGraph from './features/MultiCalendarGraph';\nimport { selectIsEventsLoading } from './stores/calendarEvents';\nimport { loadCalendars, selectCalendars } from './stores/calendars';\n\nimport styles from './Interface.module.css';\n\nconst Interface = () => {\n  const dispatch = useDispatch();\n\n  const calendars = useSelector(selectCalendars);\n  const eventsLoading = useSelector(selectIsEventsLoading);\n\n  useEffect(() => {\n    if (!calendars) {\n      dispatch(loadCalendars());\n    }\n  });\n\n  if (!calendars) {\n    return (\n      <div className={styles.initialLoading}>\n        <div className={styles.spinner} />\n        <span>Loading calendars</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.interface}>\n      {eventsLoading && (\n        <div className={styles.loadingBar}>Loading calendar events</div>\n      )}\n      <MultiCalendarGraph />\n    </div>\n  );\n};\n\nexport default Interface;\n","import React, { useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport { decode } from 'qss';\n\nimport { selectHasToken } from './stores/authentication';\n\nimport AuthScreen from './AuthScreen';\nimport Interface from './Interface';\n\nimport styles from './App.module.css';\n\nconst App = () => {\n  const hasToken = useSelector(selectHasToken);\n\n  useEffect(() => {\n    const hashParams = decode(window.location?.hash?.slice(1) ?? '');\n\n    if (hashParams.access_token) {\n      sessionStorage.setItem('accessToken', hashParams.access_token);\n      window.location = window.location.pathname.replace(/\\/$/, '') || '/';\n    }\n  }, []);\n\n  return (\n    <div className={styles.appWrapper}>\n      <div className={styles.app}>\n        <div className={styles.sticky}>\n          <div className={styles.content}>\n            <div className={styles.header}>\n              <div className={styles.headerIcon}>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <circle cx=\"12\" cy=\"12\" r=\"9\" stroke=\"#fff\" strokeWidth=\"2\" />\n                  <path d=\"M12 7v5l3.5 3.5\" stroke=\"#fff\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                </svg>\n              </div>\n              <h1 className={styles.headline}>\n                Calendar Hours\n              </h1>\n            </div>\n            {!hasToken && <AuthScreen />}\n            {hasToken && <Interface />}\n          </div>\n          <footer className={styles.footer}>\n            <p>\n              <span>Open source project  </span>\n              <a\n                href=\"https://github.com/aronwoost/google-calendar-hours\"\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                View on GitHub\n              </a>\n            </p>\n          </footer>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import { configureStore } from '@reduxjs/toolkit';\nimport dayjs from 'dayjs';\nimport weekday from 'dayjs/plugin/weekday';\n\nimport authentication from './authentication';\nimport calendars from './calendars';\nimport viewState from './viewState';\nimport calendarEvents from './calendarEvents';\nimport { getConfig } from './storage';\nimport { RANGE_TYPE, WEEK_START } from '../constants';\n\ndayjs.extend(weekday);\n\nconst getAccessToken = () => {\n  try {\n    return sessionStorage.getItem('accessToken');\n  } catch (e) {\n    // don't handle\n  }\n\n  return null;\n};\n\nconst getViewState = () => {\n  const config = getConfig() ?? {};\n  return {\n    selectedRangeType: config.selectedRangeType ?? RANGE_TYPE.MONTH,\n    currentDatePointerStart:\n      config.selectedRangeType === RANGE_TYPE.CUSTOM\n        ? config.start\n        : dayjs().startOf('day').toJSON(),\n    currentDatePointerEnd: config.end,\n    weekStart: config.weekStart ?? WEEK_START.MONDAY,\n  };\n};\n\nconst store = () =>\n  configureStore({\n    reducer: {\n      authentication,\n      calendars,\n      viewState,\n      calendarEvents,\n    },\n    preloadedState: {\n      authentication: { accessToken: getAccessToken() },\n      viewState: getViewState(),\n    },\n  });\n\nexport default store;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport './index.css';\nimport App from './App';\nimport store from './stores';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store()}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"appWrapper\":\"App_appWrapper__3rnam\",\"app\":\"App_app__1kX79\",\"sticky\":\"App_sticky__1Ko52\",\"content\":\"App_content__3La4L\",\"header\":\"App_header__3ZZ1n\",\"headerIcon\":\"App_headerIcon__3OhxF\",\"headline\":\"App_headline__1z0fO\",\"footer\":\"App_footer__29Fsv\"};"],"sourceRoot":""}