{"version":3,"sources":["features/MultiCalendarGraph.module.css","Interface.module.css","google_auth.png","stores/authentication.js","AuthScreen.js","stores/api.js","stores/calendarEvents.js","stores/calendars.js","constants.js","utils/roundHours.js","stores/viewState.js","features/MultiCalendarGraph.js","Interface.js","App.js","stores/index.js","stores/storage.js","index.js","App.module.css"],"names":["module","exports","authentication","createSlice","name","initialState","reducers","selectAccessToken","state","accessToken","selectHasToken","Boolean","App","href","params","encode","client_id","redirect_uri","window","location","origin","pathname","replace","scope","response_type","getGoogleAuthUrl","data-testid","src","logo","alt","width","height","fetchGoogle","a","url","fetch","access_token","response","status","sessionStorage","removeItem","Promise","reject","json","fetchCalendars","fetchEvents","calendarId","pageToken","acc","encodeURIComponent","singleEvents","maxResults","timeMax","dayjs","add","toJSON","items","nextPageToken","fetchCalendarEvents","calendarEvents","loadingCount","map","setCalendarEvents","payload","events","setLoading","actions","loadCalendarEvents","dispatch","getState","id","summary","start","end","dateTime","filter","selectIsEventsLoading","selectAllCalendarEventsMap","calendars","list","setCalendars","selectCalendars","RANGE_TYPE","WEEK_START","roundHours","number","Math","round","extend","isoWeek","viewState","setSelectedCalendarId","selectedCalendarId","setRangeType","selectedRangeType","changeRange","currentDatePointerStart","subtract","resetRange","startOf","setWeekStart","weekStart","setStart","setEnd","currentDatePointerEnd","computeHoursInRange","hours","forEach","evStart","evEnd","evStartDate","Date","evEndDate","selectAllCalendarsMonthlyData","eventsMap","currentYear","year","result","Object","keys","Array","from","length","_","month","d","String","padStart","label","format","toDate","endOf","selectAllCalendarsYearlyData","years","i","selectAllCalendarsWeeklyData","weeksInYear","weekNum","weekEnd","CHART_TYPE","STACKED","GROUPED","LINE","PIE","TIME_RANGE","WEEKLY","MONTHLY","YEARLY","PADDING","chartHeight","niceMax","rawMax","ceil","pieSlicePath","cx","cy","r","startAngle","endAngle","innerR","toRad","deg","PI","x1","cos","y1","sin","x2","y2","ix1","iy1","ix2","iy2","largeArc","join","MultiCalendarGraph","useSelector","monthlyData","yearlyData","weeklyData","useState","Set","checkedCalendars","setCheckedCalendars","chartType","setChartType","timeRange","setTimeRange","scrollRef","useRef","useEffect","size","c","allData","pickData","activeCalendars","has","periods","yMax","max","total","reduce","sum","cal","getStackedMax","getSingleMax","yTicks","Y_TICKS","isWeekly","periodCount","svgWidth","chartWidth","barSlotWidth","groupedBarWidth","stackedBarWidth","stackedBarOffset","renderYAxis","tick","y","key","stroke","strokeWidth","x","textAnchor","className","styles","axisLabel","renderXAxis","renderXLabels","skipEvery","p","isPie","pieSvgHeight","container","calendarList","calendarItem","type","checked","onChange","prev","next","delete","checkbox","colorDot","style","background","color","calendarName","loadingBadge","controls","controlGroup","controlLabel","toggle","toggleBtn","active","onClick","disabled","empty","chart","viewBox","aria-label","totals","grandTotal","currentAngle","slices","angle","slice","pct","toFixed","Fragment","s","fill","bar","pieCenter","pieCenterSub","ly","rx","lx","legendLabel","legendHours","renderPieChart","chartScroll","scrollable","ref","minWidth","period","periodIdx","yBottom","barH","renderStackedBars","calIdx","renderGroupedBars","calData","points","strokeLinejoin","strokeLinecap","line","indexOf","dot","renderLineChart","Interface","useDispatch","eventsLoading","backgroundColor","interface","loadingBar","hasToken","hashParams","decode","hash","setItem","appWrapper","app","sticky","content","headline","AuthScreen","footer","target","rel","weekday","getAccessToken","getItem","e","getViewState","config","JSON","parse","localStorage","err","getConfig","store","configureStore","reducer","preloadedState","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"uHACAA,EAAOC,QAAU,CAAC,UAAY,sCAAsC,aAAe,yCAAyC,aAAe,yCAAyC,SAAW,qCAAqC,SAAW,qCAAqC,aAAe,yCAAyC,aAAe,yCAAyC,SAAW,qCAAqC,aAAe,yCAAyC,aAAe,yCAAyC,OAAS,mCAAmC,UAAY,sCAAsC,OAAS,mCAAmC,YAAc,wCAAwC,WAAa,uCAAuC,MAAQ,kCAAkC,IAAM,gCAAgC,KAAO,iCAAiC,IAAM,gCAAgC,UAAY,sCAAsC,SAAW,qCAAqC,UAAY,sCAAsC,aAAe,yCAAyC,YAAc,wCAAwC,YAAc,wCAAwC,MAAQ,oC,mBCAtvCD,EAAOC,QAAU,CAAC,UAAY,6BAA6B,WAAa,gC,mBCDxED,EAAOC,QAAU,IAA0B,yC,mKCE9BC,EAAiBC,YAAY,CACxCC,KAAM,iBACNC,aAAc,KACdC,SAAU,KAGCC,EAAoB,SAACC,GAAD,OAAWA,EAAMN,eAAeO,aACpDC,EAAiB,SAACF,GAAD,OAAWG,QAAQJ,EAAkBC,KAEpDN,IAAf,Q,iBC0CeU,EA5CH,WAYV,OACE,kBAAC,WAAD,KACE,iSAOA,qFACA,uBAAGC,KArBkB,WACvB,IAAMC,EAASC,YAAO,CACpBC,UAPiB,2EAQjBC,aAAcC,OAAOC,SAASC,OAASF,OAAOC,SAASE,SAASC,QAAQ,MAAO,IAC/EC,MAPJ,6GAQIC,cAAe,UAGjB,MAAM,6CAAN,OAAoDV,GAazCW,GAAoBC,cAAY,YACvC,yBAAKC,IAAKC,IAAMC,IAAI,mBAAmBC,MAAM,MAAMC,OAAO,QAE5D,8CACA,6RAMA,iUAOA,0F,8DC3CAC,EAAW,uCAAG,mCAAAC,EAAA,6DAASC,EAAT,EAASA,IAAKzB,EAAd,EAAcA,YAAaK,EAA3B,EAA2BA,OAA3B,SACKqB,MAAM,GAAD,OACvBD,EADuB,YAChBnB,YAAO,aACfqB,aAAc3B,GACXK,MAJW,UAQM,OAPlBuB,EADY,QAQLC,OARK,uBAShBC,eAAeC,WAAW,eAC1BtB,OAAOC,SAAW,IAVF,kBAWTsB,QAAQC,UAXC,gCAaXL,EAASM,QAbE,2CAAH,sDAgBJC,EAAiB,SAAC,GAAD,IAAGnC,EAAH,EAAGA,YAAH,OAC5BuB,EAAY,CAAEE,IAAI,GAAD,OAnBG,0CAmBH,yBAA2CzB,iBAExDoC,EAAW,uCAAG,yCAAAZ,EAAA,6DAASxB,EAAT,EAASA,YAAaqC,EAAtB,EAAsBA,WAAYC,EAAlC,EAAkCA,UAAWC,EAA7C,EAA6CA,IAA7C,SACqBhB,EAAY,CACjDE,IAAI,GAAD,OAvBe,0CAuBf,qBAA+Be,mBAAmBH,GAAlD,WACHrC,cACAK,OAAQ,CACNoC,cAAc,EACdC,WAAY,KACZJ,YACAK,QAASC,MAAQC,IAAI,EAAG,QAAQC,YARlB,mBACVC,EADU,EACVA,MAAOC,EADG,EACHA,cADG,+DAaLT,GAbK,YAaGQ,KAbH,gCAgBXX,EAAY,CACjBpC,cACAqC,aACAC,UAAWU,EACXT,IAAI,GAAD,mBAAMA,GAAN,YAAcQ,OApBD,2CAAH,sDAwBJE,EAAsB,SAAC,GAAD,IAAGjD,EAAH,EAAGA,YAAaqC,EAAhB,EAAgBA,WAAhB,OACjCD,EAAY,CAAEpC,cAAaqC,aAAYE,IAAK,MC5CjCW,EAAiBxD,YAAY,CACxCC,KAAM,iBACNC,aAAc,CACZuD,aAAc,EACdC,IAAK,IAEPvD,SAAU,CACRwD,kBAAmB,SAACtD,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QAC3BvD,EAAMqD,IAAIE,EAAQjB,YAAciB,EAAQC,QAE1CC,WAAY,SAACzD,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QACpBvD,EAAMoD,cAAgBG,EAAU,GAAK,M,EAKDJ,EAAeO,QAAjDJ,E,EAAAA,kBAAmBG,E,EAAAA,WAEdE,EAAqB,SAAC,GAAD,IAAGrB,EAAH,EAAGA,WAAH,8CAAoB,WACpDsB,EACAC,GAFoD,iBAAApC,EAAA,6DAI9CxB,EAAcF,EAAkB8D,KAJc,SAMlDD,EAASH,GAAW,IAN8B,SAO9BP,EAAoB,CAAEjD,cAAaqC,eAPL,OAO5CU,EAP4C,OAQlDY,EACEN,EAAkB,CAChBhB,aACAkB,OAAQR,EACLK,KAAI,YAAkC,IAA/BS,EAA8B,EAA9BA,GAAIC,EAA0B,EAA1BA,QAASC,EAAiB,EAAjBA,MAAOC,EAAU,EAAVA,IAG1B,OAAKD,EAAME,SAKJ,CACLJ,KACAC,UACAC,MAAOA,EAAME,SACbD,IAAKA,EAAIC,UARF,QAWVC,OAAOhE,YA3BoC,yEAiClDyD,EAASH,GAAW,IAjC8B,4EAApB,yDAqCrBW,EAAwB,SAACpE,GAAD,eACnC,oBAACA,EAAMmD,sBAAP,aAAC,EAAsBC,oBAAvB,QAAuC,GAAK,GAKjCiB,EAA6B,SAACrE,GAAD,mCACxCA,EAAMmD,sBADkC,aACxC,EAAsBE,WADkB,QACX,IAEhBF,IAAf,QC/DamB,EAAY3E,YAAY,CACnCC,KAAM,YACNC,aAAc,CACZ0E,KAAM,MAERzE,SAAU,CACR0E,aAAc,SAACxE,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QACtBvD,EAAMuE,KAAOhB,MAKXiB,EAAiBF,EAAUZ,QAA3Bc,aAuBKC,EAAkB,SAACzE,GAAD,OAAWA,EAAMsE,UAAUC,MAO3CD,IAAf,Q,yBChDaI,G,MAGJ,SAHIA,EAMH,SAQGC,EACH,SCbKC,EAFI,SAACC,GAAD,OAAYC,KAAKC,MAAe,IAATF,GAAgB,KCU1DhC,IAAMmC,OAAOC,KAEN,IAAMC,EAAYvF,YAAY,CACnCC,KAAM,YACNC,aAAc,KACdC,SAAU,CACRqF,sBAAuB,SAACnF,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QAC/BvD,EAAMoF,mBAAqB7B,GAE7B8B,aAAc,SAACrF,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QACtBvD,EAAMsF,kBAAoB/B,GAE5BgC,YAAa,SAACvF,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QACL,SAAZA,EACFvD,EAAMwF,wBAA0B3C,IAAM7C,EAAMwF,yBACzCC,SAAS,EAAGzF,EAAMsF,mBAClBvC,SACkB,SAAZQ,IACTvD,EAAMwF,wBAA0B3C,IAAM7C,EAAMwF,yBACzC1C,IAAI,EAAG9C,EAAMsF,mBACbvC,WAGP2C,WAAY,SAAC1F,GACXA,EAAMwF,wBAA0B3C,MAAQ8C,QAAQ,OAAO5C,UAEzD6C,aAAc,SAAC5F,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QACtBvD,EAAM6F,UAAYtC,GAEpBuC,SAAU,SAAC9F,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QAClBvD,EAAMwF,wBAA0BjC,GAElCwC,OAAQ,SAAC/F,EAAD,GAAyB,IAAfuD,EAAc,EAAdA,QAChBvD,EAAMgG,sBAAwBzC,M,EAKO2B,EAAUxB,Q,KAAtC6B,Y,EAAaG,WAOxBR,EAAUxB,SAoGRuC,G,EAzGJd,sB,EACAE,a,EACAO,a,EACAE,S,EACAC,OAqG0B,SAACvC,EAAQQ,EAAOC,GAC1C,IAAIiC,EAAQ,EASZ,OARA1C,EAAO2C,SAAQ,YAAqC,IAA3BC,EAA0B,EAAjCpC,MAAqBqC,EAAY,EAAjBpC,IAC1BqC,EAAc,IAAIC,KAAKH,GACvBI,EAAY,IAAID,KAAKF,GACvBG,GAAaxC,GAASsC,GAAerC,IAGzCiC,KADmBM,EAAYvC,EAAMA,EAAMuC,IADtBF,EAActC,EAAQA,EAAQsC,IAEZ,IAAO,GAAK,OAE9C1B,EAAWsB,KA2CPO,EAAgC,SAACzG,GAC5C,IAAM0G,EAAYrC,EAA2BrE,GACvC2G,EAAc9D,MAAQ+D,OAEtBC,EAAS,GAgBf,OAfAC,OAAOC,KAAKL,GAAWP,SAAQ,SAAC7D,GAC9B,IAAMkB,EAASkD,EAAUpE,GACpBkB,IACLqD,EAAOvE,GAAc0E,MAAMC,KAAK,CAAEC,OAAQ,KAAM,SAACC,EAAGC,GAClD,IAAMC,EAAIxE,IAAM,GAAD,OAAI8D,EAAJ,YAAmBW,OAAOF,EAAQ,GAAGG,SAAS,EAAG,KAAjD,QACf,MAAO,CACLC,MAAOH,EAAEI,OAAO,OAChBvB,MAAOD,EACLzC,EACA6D,EAAE1B,QAAQ,SAAS+B,SACnBL,EAAEM,MAAM,SAAS7E,IAAI,EAAG,eAAe4E,kBAKxCb,GAGIe,EAA+B,SAAC5H,GAC3C,IAAM0G,EAAYrC,EAA2BrE,GACvC2G,EAAc9D,MAAQ+D,OACtBiB,EAAQb,MAAMC,KAAK,CAAEC,OAAQ,IAAK,SAACC,EAAGW,GAAJ,OAAUnB,EAAc,EAAImB,KAE9DjB,EAAS,GAaf,OAZAC,OAAOC,KAAKL,GAAWP,SAAQ,SAAC7D,GAC9B,IAAMkB,EAASkD,EAAUpE,GACpBkB,IACLqD,EAAOvE,GAAcuF,EAAMxE,KAAI,SAACuD,GAAD,MAAW,CACxCY,MAAOF,OAAOV,GACdV,MAAOD,EACLzC,EACAX,IAAM,GAAD,OAAI+D,EAAJ,WAAkBjB,QAAQ,QAAQ+B,SACvC7E,IAAM,GAAD,OAAI+D,EAAJ,WAAkBe,MAAM,QAAQ7E,IAAI,EAAG,eAAe4E,kBAI1Db,GAGIkB,EAA+B,SAAC/H,GAC3C,IAAM0G,EAAYrC,EAA2BrE,GACvC2G,EAAc9D,MAAQ+D,OAEtBoB,EAAcnF,IAAM,GAAD,OAAI8D,EAAJ,WAAyB1B,UAE5C4B,EAAS,GAuBf,OAtBAC,OAAOC,KAAKL,GAAWP,SAAQ,SAAC7D,GAC9B,IAAMkB,EAASkD,EAAUpE,GACpBkB,IACLqD,EAAOvE,GAAc0E,MAAMC,KAAK,CAAEC,OAAQc,IAAe,SAACb,EAAGW,GAC3D,IAAMG,EAAUH,EAAI,EACdjC,EAAYhD,MACf+D,KAAKD,GACL1B,QAAQgD,GACRtC,QAAQ,WACR+B,SACGQ,EAAUrF,MACb+D,KAAKD,GACL1B,QAAQgD,GACRN,MAAM,WACN7E,IAAI,EAAG,eACP4E,SACH,MAAO,CACLF,MAAM,IAAD,OAAMS,GACX/B,MAAOD,EAAoBzC,EAAQqC,EAAWqC,WAI7CrB,GAyCM3B,KAAf,Q,mBCtTMiD,GAAa,CACjBC,QAAS,UACTC,QAAS,UACTC,KAAM,OACNC,IAAK,OAGDC,GAAa,CACjBC,OAAQ,SACRC,QAAS,UACTC,OAAQ,UAIJC,GAAiB,GAAjBA,GAA4B,GAA5BA,GAAkD,GAGlDC,GAJmB,IAIcD,GAHO,GAK9C,SAASE,GAAQC,GACf,OAAKA,GAAqB,IAAXA,EALD,EAMPjE,KAAKkE,KAAKD,EANH,KAgBhB,SAASE,GAAaC,EAAIC,EAAIC,EAAGC,EAAYC,EAAUC,GACrD,IAAMC,EAAQ,SAACC,GAAD,OAAUA,EAAM3E,KAAK4E,GAAM,KACnCC,EAAKT,EAAKE,EAAItE,KAAK8E,IAAIJ,EAAMH,IAC7BQ,EAAKV,EAAKC,EAAItE,KAAKgF,IAAIN,EAAMH,IAC7BU,EAAKb,EAAKE,EAAItE,KAAK8E,IAAIJ,EAAMF,IAC7BU,EAAKb,EAAKC,EAAItE,KAAKgF,IAAIN,EAAMF,IAC7BW,EAAMf,EAAKK,EAASzE,KAAK8E,IAAIJ,EAAMF,IACnCY,EAAMf,EAAKI,EAASzE,KAAKgF,IAAIN,EAAMF,IACnCa,EAAMjB,EAAKK,EAASzE,KAAK8E,IAAIJ,EAAMH,IACnCe,EAAMjB,EAAKI,EAASzE,KAAKgF,IAAIN,EAAMH,IACnCgB,EAAWf,EAAWD,EAAa,IAAM,EAAI,EACnD,MAAO,CAAC,KAAD,OACAM,EADA,YACME,GADN,YAEAT,EAFA,YAEKA,EAFL,cAEYiB,EAFZ,cAE0BN,EAF1B,YAEgCC,GAFhC,YAGAC,EAHA,YAGOC,GAHP,YAIAX,EAJA,YAIUA,EAJV,cAIsBc,EAJtB,cAIoCF,EAJpC,YAI2CC,GAChD,KACAE,KAAK,KAGT,IA8deC,GA9dY,WACzB,IAAMjG,EAAYkG,YAAY/F,GACxBgG,EAAcD,YAAY/D,GAC1BiE,EAAaF,YAAY5C,GACzB+C,EAAaH,YAAYzC,GAJA,EAMiB6C,mBAAS,IAAIC,KAN9B,mBAMxBC,EANwB,KAMNC,EANM,OAOGH,mBAASzC,GAAWC,SAPvB,mBAOxB4C,EAPwB,KAObC,EAPa,OAQGL,mBAASpC,GAAWE,SARvB,mBAQxBwC,EARwB,KAQbC,EARa,KASzBC,EAAYC,iBAAO,MAGzBC,qBAAU,WACJhH,GAAuC,IAA1BwG,EAAiBS,MAChCR,EAAoB,IAAIF,IAAIvG,EAAUjB,KAAI,SAACmI,GAAD,OAAOA,EAAE1H,UAEpD,CAACQ,EAAWwG,EAAiBS,OAEhC,IAaME,EA1DR,SAAkBP,EAAWP,EAAYF,EAAaC,GACpD,OAAIQ,IAAc1C,GAAWC,OAAekC,EACxCO,IAAc1C,GAAWE,QAAgB+B,EACtCC,EAuDSgB,CAASR,EAAWP,EAAYF,EAAaC,GAGvDiB,GAAmBrH,GAAa,IAAIH,QACxC,SAACqH,GAAD,OAAOV,EAAiBc,IAAIJ,EAAE1H,KAAO2H,EAAQD,EAAE1H,OAK3C+H,GADYF,EAAgBzE,OAAS,EAAIuE,EAAQE,EAAgB,GAAG7H,IAAM,KACnD,GA0BvBgI,EACJd,IAAc7C,GAAWC,QAxBL,WACpB,GAAuB,IAAnByD,EAAQ3E,OAAc,OAhFd,EAiFZ,IAAI6E,EAAM,EAQV,OAPAF,EAAQ1F,SAAQ,SAACgB,EAAGW,GAClB,IAAMkE,EAAQL,EAAgBM,QAC5B,SAACC,EAAKC,GAAN,eAAcD,IAAO,UAAAT,EAAQU,EAAIrI,WAAZ,mBAAkBgE,UAAlB,eAAsB5B,QAAS,KACpD,GAEE8F,EAAQD,IAAKA,EAAMC,MAElBlD,GAAQiD,GAcoBK,GAXhB,WACnB,IAAIL,EAAM,EAMV,OALAJ,EAAgBxF,SAAQ,SAACgG,IACtBV,EAAQU,EAAIrI,KAAO,IAAIqC,SAAQ,YAAgB,IAAbD,EAAY,EAAZA,MAC7BA,EAAQ6F,IAAKA,EAAM7F,SAGpB4C,GAAQiD,GAIsCM,GACjDC,EAAStF,MAAMC,KAAK,CAAEC,OAAQqF,IAAe,SAACpF,EAAGW,GAAJ,OACjDhD,KAAKC,MAAO+G,EAzGA,EAyGkBhE,MAI1B0E,EAAWtB,IAAc1C,GAAWC,OACpCgE,EAAcZ,EAAQ3E,QAAU,EAGhCwF,EAAWF,EACb1H,KAAKiH,IAAI,IAAmB,GAAdU,EAAmB7D,GAAeA,IAChD,IACE+D,EAAaD,EAAW9D,GAAeA,GAGvCgE,EAAeD,EAAa7H,KAAKiH,IAAIU,EAAa,GAClDI,EACJlB,EAAgBzE,OAAS,EACL,GAAf0F,EAAsBjB,EAAgBzE,OACxB,GAAf0F,EACAE,EAAiC,GAAfF,EAClBG,EAAkC,GAAfH,EAInBI,EAAc,kBAClBV,EAAOjJ,KAAI,SAAC4J,GACV,IAAMC,EAAItE,GAAcC,GAAeoE,EAAOnB,EAAQjD,GACtD,OACE,uBAAGsE,IAAKF,GACN,0BACEtD,GAAIf,GACJiB,GAAIqD,EACJnD,GAAInB,GAAe+D,EACnB3C,GAAIkD,EACJE,OAAO,UACPC,YAAY,MAEd,0BACEC,EAAG1E,GAAe,EAClBsE,EAAGA,EAAI,EACPK,WAAW,MACXC,UAAWC,KAAOC,WAEjBT,EANH,UAYFU,EAAc,kBAClB,0BACEhE,GAAIf,GACJiB,GAAIjB,GAAcC,GAClBkB,GAAInB,GAAe+D,EACnB3C,GAAIpB,GAAcC,GAClBuE,OAAO,OACPC,YAAY,OAIVO,EAAgB,eAACC,EAAD,uDAAa,EAAb,OACpBhC,EAAQxI,KAAI,SAACyK,EAAGhG,GACd,GAAIA,EAAI+F,IAAc,EAAG,OAAO,KAChC,IAAMP,EAAI1E,GAAed,EAAI8E,EAAeA,EAAe,EAC3D,OACE,0BACEO,IAAKW,EAAEtG,MACP8F,EAAGA,EACHJ,EAAGtE,GAAcC,GAAc,GAC/B0E,WAAW,SACXC,UAAWC,KAAOC,WAEjBI,EAAEtG,WA4NLuG,EAAQ/C,IAAc7C,GAAWI,IAEjCyF,EAAelJ,KAAKiH,IAAI,IAA8B,GAAzBJ,EAAgBzE,OAAc,IAwCjE,OACE,yBAAKsG,UAAWC,KAAOQ,WAErB,yBAAKT,UAAWC,KAAOS,eACnB5J,GAAa,IAAIjB,KAAI,SAAC8I,GAAD,OACrB,2BAAOgB,IAAKhB,EAAIrI,GAAI0J,UAAWC,KAAOU,cACpC,2BACEC,KAAK,WACLC,QAASvD,EAAiBc,IAAIO,EAAIrI,IAClCwK,SAAU,kBA1YEhM,EA0YmB6J,EAAIrI,QAzY7CiH,GAAoB,SAACwD,GACnB,IAAMC,EAAO,IAAI3D,IAAI0D,GAMrB,OALIC,EAAK5C,IAAItJ,GACXkM,EAAKC,OAAOnM,GAEZkM,EAAK1L,IAAIR,GAEJkM,KARY,IAAClM,GA2YZkL,UAAWC,KAAOiB,WAEpB,0BACElB,UAAWC,KAAOkB,SAClBC,MAAO,CAAEC,WAAY1C,EAAI2C,SAE3B,0BAAMtB,UAAWC,KAAOsB,cAAe5C,EAAI3E,QACzCiE,EAAQU,EAAIrI,KACZ,0BAAM0J,UAAWC,KAAOuB,cAAxB,sBAOR,yBAAKxB,UAAWC,KAAOwB,UACrB,yBAAKzB,UAAWC,KAAOyB,cACrB,0BAAM1B,UAAWC,KAAO0B,cAAxB,SACA,yBAAK3B,UAAWC,KAAO2B,QACpB,CACC,CAAEjC,IAAKhF,GAAWC,QAASZ,MAAO,WAClC,CAAE2F,IAAKhF,GAAWE,QAASb,MAAO,WAClC,CAAE2F,IAAKhF,GAAWG,KAAMd,MAAO,QAC/B,CAAE2F,IAAKhF,GAAWI,IAAKf,MAAO,QAC9BnE,KAAI,gBAAG8J,EAAH,EAAGA,IAAK3F,EAAR,EAAQA,MAAR,OACJ,4BACE2F,IAAKA,EACLiB,KAAK,SACLZ,UAAS,UAAKC,KAAO4B,UAAZ,YAAyBrE,IAAcmC,EAAMM,KAAO6B,OAAS,IACtEC,QAAS,kBAAMtE,EAAakC,KAE3B3F,QAMT,yBAAKgG,UAAWC,KAAOyB,cACrB,0BAAM1B,UAAWC,KAAO0B,cAAxB,UACA,yBAAK3B,UAAWC,KAAO2B,QACpB,CACC,CAAEjC,IAAK3E,GAAWC,OAAQjB,MAAO,UACjC,CAAE2F,IAAK3E,GAAWE,QAASlB,MAAO,WAClC,CAAE2F,IAAK3E,GAAWG,OAAQnB,MAAO,WACjCnE,KAAI,gBAAG8J,EAAH,EAAGA,IAAK3F,EAAR,EAAQA,MAAR,OACJ,4BACE2F,IAAKA,EACLiB,KAAK,SACLZ,UAAS,UAAKC,KAAO4B,UAAZ,YAAyBnE,IAAciC,EAAMM,KAAO6B,OAAS,IACtEC,QAAS,kBAAMpE,EAAagC,IAC5BqC,SAAUzB,GAETvG,SAnGkB,IAA3BmE,EAAgBzE,OAEhB,yBAAKsG,UAAWC,KAAOgC,OAAvB,mDAKA1B,EAEA,yBACEP,UAAWC,KAAOiC,MAClBC,QAAO,cAfK,IAeL,YAAwB3B,GAC/B4B,aAAW,gCAjGI,WAErB,IAAMC,EAASlE,EAAgBtI,KAAI,SAAC8I,GAClC,IAAMH,GAASP,EAAQU,EAAIrI,KAAO,IAAImI,QACpC,SAACC,EAAK7E,GAAN,OAAY6E,EAAM7E,EAAEnB,QACpB,GAEF,OAAO,2BAAKiG,GAAZ,IAAiBH,aAEb8D,EAAaD,EAAO5D,QAAO,SAACC,EAAKV,GAAN,OAAYU,EAAMV,EAAEQ,QAAO,GAE5D,GAAmB,IAAf8D,EACF,OACE,0BAAMxC,EAAE,MAAMJ,EAAE,MAAMK,WAAW,SAASC,UAAWC,KAAOC,WAA5D,WAMJ,IAKIqC,GAAgB,GACdC,EAASH,EACZ1L,QAAO,SAACqH,GAAD,OAAOA,EAAEQ,MAAQ,KACxB3I,KAAI,SAAC8I,GACJ,IAAM8D,EAAS9D,EAAIH,MAAQ8D,EAAc,IACnCI,EAAK,2BACN/D,GADM,IAET9C,WAAY0G,EACZzG,SAAUyG,EAAeE,EACzBE,KAAOhE,EAAIH,MAAQ8D,EAAc,KAAKM,QAAQ,KAGhD,OADAL,GAAgBE,EACTC,KAGX,OACE,kBAAC,IAAMG,SAAP,KACGL,EAAO3M,KAAI,SAACiN,GAAD,OACV,0BACEnD,IAAKmD,EAAExM,GACPuD,EAAG4B,GAzBA,IACA,IACD,GAuByBqH,EAAEjH,WAAYiH,EAAEhH,SAtBpC,IAuBPiH,KAAMD,EAAExB,MACR1B,OAAO,OACPC,YAAY,IACZG,UAAWC,KAAO+C,KAElB,yCAAWF,EAAE9I,MAAb,aAAuB8I,EAAEtE,MAAMoE,QAAQ,GAAvC,cAA+CE,EAAEH,IAAjD,WAIJ,0BAAM7C,EAnCC,IAmCMJ,EAAG/D,IAAQoE,WAAW,SAASC,UAAWC,KAAOgD,WAC3DX,EAAWM,QAAQ,GADtB,KAGA,0BAAM9C,EAtCC,IAsCMJ,EAAG/D,IAASoE,WAAW,SAASC,UAAWC,KAAOiD,cAA/D,SAICV,EAAO3M,KAAI,SAACiN,EAAGxI,GACd,IACM6I,EAAK,GAAS,GAAJ7I,EAChB,OACE,uBAAGqF,IAAKmD,EAAExM,IACR,0BAAMwJ,EAJC,IAIMJ,EAAGyD,EAAIrP,MAAO,GAAIC,OAAQ,GAAIgP,KAAMD,EAAExB,MAAO8B,GAAG,MAC7D,0BAAMtD,EAAGuD,IAAS3D,EAAGyD,EAAK,GAAInD,UAAWC,KAAOqD,aAC7CR,EAAE9I,OAEL,0BAAM8F,EAAGuD,IAAU3D,EAAGyD,EAAK,GAAIpD,WAAW,MAAMC,UAAWC,KAAOsD,aAC/DT,EAAEtE,MAAMoE,QAAQ,GADnB,MAC0BE,EAAEH,IAD5B,WA6BHa,IAKL,yBACExD,UAAS,UAAKC,KAAOwD,YAAZ,YAA2BzE,EAAWiB,KAAOyD,WAAa,IACnEC,IAAK/F,GAEL,yBACEoC,UAAWC,KAAOiC,MAClBC,QAAO,cAASjD,EAAT,YA7aQ,KA8afkC,MAAOpC,EAAW,CAAE4E,SAAU1E,GAAa,GAC3CkD,aAAA,UAAe5E,EAAf,YAA4BE,EAA5B,iBAECF,IAAc7C,GAAWC,SAzPR,WACxB,IAAMyF,EAAYrB,EAAW,EAAI,EACjC,OACE,kBAAC,IAAM6D,SAAP,KACGrD,IACAW,IACAC,EAAcC,GACdhC,EAAQxI,KAAI,SAACgO,EAAQC,GACpB,IAAMhE,EACJ1E,GAAe0I,EAAY1E,EAAeG,EACxCwE,EAAU3I,GAAcC,GAE5B,OACE,uBAAGsE,IAAKkE,EAAO7J,OACZmE,EAAgBtI,KAAI,SAAC8I,GAAS,IAAD,IACtBjG,GAAQ,UAAAuF,EAAQU,EAAIrI,WAAZ,mBAAkBwN,UAAlB,eAA8BpL,QAAS,EACrD,GAAc,IAAVA,EAAa,OAAO,KACxB,IAAMsL,EAAQtL,EAAQ4F,EAAQjD,GACxBqE,EAAIqE,EAAUC,EAEpB,OADAD,EAAUrE,EAER,0BACEC,IAAKhB,EAAIrI,GACTwJ,EAAGA,EACHJ,EAAGA,EACH5L,MAAOwL,EACPvL,OAAQiQ,EACRjB,KAAMpE,EAAI2C,MACV8B,GAAG,IACHpD,UAAWC,KAAO+C,KAElB,yCAAWrE,EAAI3E,MAAf,mBAA0B6J,EAAO7J,MAAjC,aAA2CtB,EAA3C,eA0N2BuL,GACpCzG,IAAc7C,GAAWE,SAhNR,WACxB,IAAMwF,EAAYrB,EAAW,EAAI,EACjC,OACE,kBAAC,IAAM6D,SAAP,KACGrD,IACAW,IACAC,EAAcC,GACdhC,EAAQxI,KAAI,SAACgO,EAAQC,GAAT,OACX,uBAAGnE,IAAKkE,EAAO7J,OACZmE,EAAgBtI,KAAI,SAAC8I,EAAKuF,GAAY,IAAD,IAC9BxL,GAAQ,UAAAuF,EAAQU,EAAIrI,WAAZ,mBAAkBwN,UAAlB,eAA8BpL,QAAS,EAC/CsL,EAAO1M,KAAKiH,IAAK7F,EAAQ4F,EAAQjD,GAAa3C,EAAQ,EAAI,EAAI,GAC9DoH,EACJ1E,GACA0I,EAAY1E,EACG,GAAfA,EACA8E,EAAS7E,EACLK,EAAItE,GAAcC,GAAc2I,EACtC,OACE,0BACErE,IAAKhB,EAAIrI,GACTwJ,EAAGA,EACHJ,EAAGA,EACH5L,MAAOwD,KAAKiH,IAAIc,EAAkB,EAAG,GACrCtL,OAAQiQ,EACRjB,KAAMpE,EAAI2C,MACV8B,GAAG,IACHpD,UAAWC,KAAO+C,KAElB,yCAAWrE,EAAI3E,MAAf,mBAA0B6J,EAAO7J,MAAjC,aAA2CtB,EAA3C,eAmL6ByL,GACpC3G,IAAc7C,GAAWG,MA1KV,WACtB,IAAMuF,EAAYrB,EAAW,EAAI,EACjC,OACE,kBAAC,IAAM6D,SAAP,KACGrD,IACAW,IACAC,EAAcC,GACdlC,EAAgBtI,KAAI,SAAC8I,GACpB,IAAMyF,EAAUnG,EAAQU,EAAIrI,KAAO,GAC7B+N,EAASD,EACZvO,KAAI,SAACgE,EAAGS,GACP,IAAMwF,EAAI1E,GAAed,EAAI8E,EAAeA,EAAe,EACrDM,EACJtE,GAAcC,GAAexB,EAAEnB,MAAQ4F,EAAQjD,GACjD,MAAM,GAAN,OAAUyE,EAAV,YAAeJ,MAEhB5C,KAAK,KAER,OACE,uBAAG6C,IAAKhB,EAAIrI,IACV,8BACE+N,OAAQA,EACRtB,KAAK,OACLnD,OAAQjB,EAAI2C,MACZzB,YAAY,IACZyE,eAAe,QACfC,cAAc,QACdvE,UAAWC,KAAOuE,OAEnBJ,EAAQvO,KAAI,SAACgE,GACZ,GAAgB,IAAZA,EAAEnB,MAAa,OAAO,KAC1B,IAAMoH,EAAI1E,GAAegJ,EAAQK,QAAQ5K,GAAKuF,EAAeA,EAAe,EACtEM,EACJtE,GAAcC,GAAexB,EAAEnB,MAAQ4F,EAAQjD,GACjD,OACE,4BACEsE,IAAK9F,EAAEG,MACP0B,GAAIoE,EACJnE,GAAI+D,EACJ9D,EAAE,IACFmH,KAAMpE,EAAI2C,MACVtB,UAAWC,KAAOyE,KAElB,yCAAW/F,EAAI3E,MAAf,mBAA0BH,EAAEG,MAA5B,aAAsCH,EAAEnB,MAAxC,eA+HwBiM,O,oBCza7BC,GA1BG,WAChB,IAAMxO,EAAWyO,cAEX/N,EAAYkG,YAAY/F,GACxB6N,EAAgB9H,YAAYpG,GAQlC,OANAkH,qBAAU,WACHhH,GACHV,ELGuB,uCAAM,WAAOA,EAAUC,GAAjB,qBAAApC,EAAA,6DAC3BxB,EAAcF,EAAkB8D,KADL,kBAGPzB,EAAe,CAAEnC,gBAHV,gBAGvB+C,EAHuB,EAGvBA,MACFkL,EAAelL,EAAMK,KAAI,kBAAuC,CACpES,GAD6B,EAAGA,GAEhC0D,MAF6B,EAAOzD,QAGpC+K,MAH6B,EAAgByD,iBAGnB,cAG5B3O,EAASY,EAAa0J,IAGtBA,EAAa/H,SAAQ,YAAa,IAAVrC,EAAS,EAATA,GACtBF,EAASD,EAAmB,CAAErB,WAAYwB,QAdb,4GAAN,4DKCtBQ,EAKH,yBAAKkJ,UAAWC,KAAO+E,WACpBF,GACC,yBAAK9E,UAAWC,KAAOgF,YAAvB,iCAEF,kBAAC,GAAD,OARK,yBAAKjF,UAAWC,KAAO+E,WAAvB,4B,mBC+BIpS,GA1CH,WACV,IAAMsS,EAAWlI,YAAYtK,GAW7B,OATAoL,qBAAU,WAAO,IAAD,MACRqH,EAAaC,YAAM,oBAAClS,OAAOC,gBAAR,iBAAC,EAAiBkS,YAAlB,aAAC,EAAuB3C,MAAM,UAA9B,QAAoC,IAEzDyC,EAAW/Q,eACbG,eAAe+Q,QAAQ,cAAeH,EAAW/Q,cACjDlB,OAAOC,SAAWD,OAAOC,SAASE,SAASC,QAAQ,MAAO,KAAO,OAElE,IAGD,yBAAK0M,UAAWC,KAAOsF,YACrB,yBAAKvF,UAAWC,KAAOuF,KACrB,yBAAKxF,UAAWC,KAAOwF,QACrB,yBAAKzF,UAAWC,KAAOyF,SACrB,wBAAI1F,UAAWC,KAAO0F,UAAtB,qCAGET,GAAY,kBAACU,EAAD,MACbV,GAAY,kBAAC,GAAD,OAEf,4BAAQlF,UAAWC,KAAO4F,QACxB,2BACE,6EACA,uBACEhT,KAAK,qDACLiT,OAAO,SACPC,IAAI,cAHN,sBAOA,yC,oBCjCd1Q,IAAMmC,OAAOwO,MAEb,IAAMC,GAAiB,WACrB,IACE,OAAO1R,eAAe2R,QAAQ,eAC9B,MAAOC,IAIT,OAAO,MAGHC,GAAe,WAAO,IAAD,MACnBC,EAAM,UCRW,WACvB,IACE,OAAOC,KAAKC,MAAMrT,OAAOsT,aAAaN,QAAQ,WAC9C,MAAOO,IAGT,OAAO,KDEQC,UAAH,QAAkB,GAC9B,MAAO,CACL5O,kBAAiB,UAAEuO,EAAOvO,yBAAT,QAA8BZ,EAC/Cc,wBACEqO,EAAOvO,oBAAsBZ,EACzBmP,EAAO7P,MACPnB,MAAQ8C,QAAQ,OAAO5C,SAC7BiD,sBAAuB6N,EAAO5P,IAC9B4B,UAAS,UAAEgO,EAAOhO,iBAAT,QAAsBlB,IAkBpBwP,GAdD,kBACZC,YAAe,CACbC,QAAS,CACP3U,iBACA4E,YACAY,aACA/B,kBAEFmR,eAAgB,CACd5U,eAAgB,CAAEO,YAAawT,MAC/BvO,UAAW0O,SEtCjBW,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,IAAD,CAAUN,MAAOA,MACf,kBAAC,GAAD,QAGJO,SAASC,eAAe,U,kBCb1BnV,EAAOC,QAAU,CAAC,WAAa,wBAAwB,IAAM,iBAAiB,OAAS,oBAAoB,QAAU,qBAAqB,SAAW,sBAAsB,OAAS,uB","file":"static/js/main.1eb3be63.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"MultiCalendarGraph_container__2G71p\",\"calendarList\":\"MultiCalendarGraph_calendarList__3jRWa\",\"calendarItem\":\"MultiCalendarGraph_calendarItem__Mk0B2\",\"checkbox\":\"MultiCalendarGraph_checkbox__fsU-E\",\"colorDot\":\"MultiCalendarGraph_colorDot__3_d2y\",\"calendarName\":\"MultiCalendarGraph_calendarName__3nR4m\",\"loadingBadge\":\"MultiCalendarGraph_loadingBadge__3pyf6\",\"controls\":\"MultiCalendarGraph_controls__12q7U\",\"controlGroup\":\"MultiCalendarGraph_controlGroup__1NsfH\",\"controlLabel\":\"MultiCalendarGraph_controlLabel__13Uxl\",\"toggle\":\"MultiCalendarGraph_toggle__db6Z1\",\"toggleBtn\":\"MultiCalendarGraph_toggleBtn__1eNci\",\"active\":\"MultiCalendarGraph_active__32ScX\",\"chartScroll\":\"MultiCalendarGraph_chartScroll__2GeQ4\",\"scrollable\":\"MultiCalendarGraph_scrollable__2kvc2\",\"chart\":\"MultiCalendarGraph_chart__16vJK\",\"bar\":\"MultiCalendarGraph_bar__2K_Z1\",\"line\":\"MultiCalendarGraph_line__BF4qH\",\"dot\":\"MultiCalendarGraph_dot__2QBOC\",\"axisLabel\":\"MultiCalendarGraph_axisLabel__3nRHM\",\"barLabel\":\"MultiCalendarGraph_barLabel__3qVhH\",\"pieCenter\":\"MultiCalendarGraph_pieCenter__Vmksl\",\"pieCenterSub\":\"MultiCalendarGraph_pieCenterSub__tPuQY\",\"legendLabel\":\"MultiCalendarGraph_legendLabel__3-Ve4\",\"legendHours\":\"MultiCalendarGraph_legendHours__3JWVK\",\"empty\":\"MultiCalendarGraph_empty__BB_rg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"interface\":\"Interface_interface__1pJyE\",\"loadingBar\":\"Interface_loadingBar__1Nzqm\"};","module.exports = __webpack_public_path__ + \"static/media/google_auth.75a7cb04.png\";","import { createSlice } from '@reduxjs/toolkit';\n\nexport const authentication = createSlice({\n  name: 'authentication',\n  initialState: null,\n  reducers: {},\n});\n\nexport const selectAccessToken = (state) => state.authentication.accessToken;\nexport const selectHasToken = (state) => Boolean(selectAccessToken(state));\n\nexport default authentication.reducer;\n","import React, { Fragment } from 'react';\nimport { encode } from 'qss';\n\nimport logo from './google_auth.png';\n\nconst googleClientId = '386288482739-qv303lmckdqrmksk8mqpihpfu4o8kc7k.apps.googleusercontent.com';\nconst googleScope =\n  'https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events.readonly';\n\nconst App = () => {\n  const getGoogleAuthUrl = () => {\n    const params = encode({\n      client_id: googleClientId,\n      redirect_uri: window.location.origin + window.location.pathname.replace(/\\/$/, ''),\n      scope: googleScope,\n      response_type: 'token',\n    });\n\n    return `https://accounts.google.com/o/oauth2/auth?${params}`;\n  };\n\n  return (\n    <Fragment>\n      <p>\n        This web app lets you see how many hours you spend on a Google Calendar.\n        It uses the Google Calendar API to fetch your calendars and events,\n        crunches the data and displays it nicely. You can filter by day, week,\n        month, year, total or add a custom time range.\n      </p>\n\n      <p>You need to authorize the app with the following link:</p>\n      <a href={getGoogleAuthUrl()} data-testid=\"AuthLink\">\n        <img src={logo} alt=\"Auth with Google\" width=\"191\" height=\"46\" />\n      </a>\n      <h3>Privacy Policy</h3>\n      <p>\n        This app connects to the Google Calendar API to fetch your calendars and\n        events, so that it can calculate the hours. This connection happens\n        directly from your browser to the Google API. There are no server or\n        services involved that might cache the data.\n      </p>\n      <p>\n        None of the data fetched from the Google Calendar API is saved elsewhere\n        but in your browser. After you close the browser window/tab all\n        authentication data is delete (technical detail: sessionStorage is\n        used). Thats why you need to reauthorize with Google the next time you\n        visit the page.\n      </p>\n      <p>This app only has read-only access to your calendar data.</p>\n    </Fragment>\n  );\n};\n\nexport default App;\n","import { encode } from 'qss';\nimport dayjs from 'dayjs';\n\nconst API_BASE_PATH = 'https://www.googleapis.com/calendar/v3/';\n\nconst fetchGoogle = async ({ url, accessToken, params }) => {\n  const response = await fetch(\n    `${url}?${encode({\n      access_token: accessToken,\n      ...params,\n    })}`\n  );\n\n  if (response.status !== 200) {\n    sessionStorage.removeItem('accessToken');\n    window.location = '/';\n    return Promise.reject();\n  }\n  return response.json();\n};\n\nexport const fetchCalendars = ({ accessToken }) =>\n  fetchGoogle({ url: `${API_BASE_PATH}users/me/calendarList`, accessToken });\n\nconst fetchEvents = async ({ accessToken, calendarId, pageToken, acc }) => {\n  const { items, nextPageToken } = await fetchGoogle({\n    url: `${API_BASE_PATH}calendars/${encodeURIComponent(calendarId)}/events`,\n    accessToken,\n    params: {\n      singleEvents: true,\n      maxResults: 2500,\n      pageToken,\n      timeMax: dayjs().add(2, 'year').toJSON(),\n    },\n  });\n\n  if (!nextPageToken) {\n    return [...acc, ...items];\n  }\n\n  return fetchEvents({\n    accessToken,\n    calendarId,\n    pageToken: nextPageToken,\n    acc: [...acc, ...items],\n  });\n};\n\nexport const fetchCalendarEvents = ({ accessToken, calendarId }) =>\n  fetchEvents({ accessToken, calendarId, acc: [] });\n","import { createSlice } from '@reduxjs/toolkit';\n\nimport { selectAccessToken } from './authentication';\nimport { fetchCalendarEvents } from './api';\n\nexport const calendarEvents = createSlice({\n  name: 'calendarEvents',\n  initialState: {\n    loadingCount: 0,\n    map: {},\n  },\n  reducers: {\n    setCalendarEvents: (state, { payload }) => {\n      state.map[payload.calendarId] = payload.events;\n    },\n    setLoading: (state, { payload }) => {\n      state.loadingCount += payload ? 1 : -1;\n    },\n  },\n});\n\nconst { setCalendarEvents, setLoading } = calendarEvents.actions;\n\nexport const loadCalendarEvents = ({ calendarId }) => async (\n  dispatch,\n  getState\n) => {\n  const accessToken = selectAccessToken(getState());\n  try {\n    dispatch(setLoading(true));\n    const items = await fetchCalendarEvents({ accessToken, calendarId });\n    dispatch(\n      setCalendarEvents({\n        calendarId,\n        events: items\n          .map(({ id, summary, start, end }) => {\n            // Filter out events that have no `dateTime`. Those are full day\n            // events, they only have the field `date`.\n            if (!start.dateTime) {\n              return null;\n            }\n\n            // only return the fields we need\n            return {\n              id,\n              summary,\n              start: start.dateTime,\n              end: end.dateTime,\n            };\n          })\n          .filter(Boolean),\n      })\n    );\n  } catch (e) {\n    // do nothing\n  } finally {\n    dispatch(setLoading(false));\n  }\n};\n\nexport const selectIsEventsLoading = (state) =>\n  (state.calendarEvents?.loadingCount ?? 0) > 0;\n\nexport const selectCalendarEvents = (state, calendarId) =>\n  state.calendarEvents?.map[calendarId] ?? null;\n\nexport const selectAllCalendarEventsMap = (state) =>\n  state.calendarEvents?.map ?? {};\n\nexport default calendarEvents.reducer;\n","import { createSlice } from '@reduxjs/toolkit';\n\nimport { selectAccessToken } from './authentication';\nimport { fetchCalendars } from './api';\nimport { loadCalendarEvents } from './calendarEvents';\n\nexport const calendars = createSlice({\n  name: 'calendars',\n  initialState: {\n    list: null,\n  },\n  reducers: {\n    setCalendars: (state, { payload }) => {\n      state.list = payload;\n    },\n  },\n});\n\nconst { setCalendars } = calendars.actions;\n\nexport const loadCalendars = () => async (dispatch, getState) => {\n  const accessToken = selectAccessToken(getState());\n  try {\n    const { items } = await fetchCalendars({ accessToken });\n    const calendarList = items.map(({ id, summary, backgroundColor }) => ({\n      id,\n      label: summary,\n      color: backgroundColor || '#4285f4',\n    }));\n\n    dispatch(setCalendars(calendarList));\n\n    // Load events for all calendars in parallel\n    calendarList.forEach(({ id }) => {\n      dispatch(loadCalendarEvents({ calendarId: id }));\n    });\n  } catch (e) {\n    // do nothing\n  }\n};\n\nexport const selectCalendars = (state) => state.calendars.list;\n\nexport const selectCalendarColor = (state, calendarId) => {\n  const calendar = state.calendars.list?.find(({ id }) => id === calendarId);\n  return calendar?.color || '#4285f4';\n};\n\nexport default calendars.reducer;\n","export const RANGE_TYPE = {\n  DAY: 'day',\n  WEEK: 'week',\n  MONTH: 'month',\n  YEAR: 'year',\n  TOTAL: 'total',\n  CUSTOM: 'custom',\n};\n\nexport const SORT_BY = {\n  DATE: 'date',\n  AMOUNT: 'amount',\n};\n\nexport const WEEK_START = {\n  MONDAY: 'monday',\n  SUNDAY: 'sunday',\n};\n","const roundHours = (number) => Math.round(number * 100) / 100;\n\nexport default roundHours;\n","import { createSlice } from '@reduxjs/toolkit';\nimport dayjs from 'dayjs';\nimport isoWeek from 'dayjs/plugin/isoWeek';\nimport 'dayjs/locale/de';\n\nimport { loadCalendarEvents, selectCalendarEvents, selectAllCalendarEventsMap } from './calendarEvents';\nimport { updateConfig } from './storage';\nimport { RANGE_TYPE, WEEK_START } from '../constants';\nimport roundHours from '../utils/roundHours';\n\ndayjs.extend(isoWeek);\n\nexport const viewState = createSlice({\n  name: 'viewState',\n  initialState: null,\n  reducers: {\n    setSelectedCalendarId: (state, { payload }) => {\n      state.selectedCalendarId = payload;\n    },\n    setRangeType: (state, { payload }) => {\n      state.selectedRangeType = payload;\n    },\n    changeRange: (state, { payload }) => {\n      if (payload === 'prev') {\n        state.currentDatePointerStart = dayjs(state.currentDatePointerStart)\n          .subtract(1, state.selectedRangeType)\n          .toJSON();\n      } else if (payload === 'next') {\n        state.currentDatePointerStart = dayjs(state.currentDatePointerStart)\n          .add(1, state.selectedRangeType)\n          .toJSON();\n      }\n    },\n    resetRange: (state) => {\n      state.currentDatePointerStart = dayjs().startOf('day').toJSON();\n    },\n    setWeekStart: (state, { payload }) => {\n      state.weekStart = payload;\n    },\n    setStart: (state, { payload }) => {\n      state.currentDatePointerStart = payload;\n    },\n    setEnd: (state, { payload }) => {\n      state.currentDatePointerEnd = payload;\n    },\n  },\n});\n\nexport const { changeRange, resetRange } = viewState.actions;\nconst {\n  setSelectedCalendarId,\n  setRangeType,\n  setWeekStart,\n  setStart,\n  setEnd,\n} = viewState.actions;\n\nexport const selectSelectedCalendar = (state) =>\n  state.viewState.selectedCalendarId;\n\nexport const selectDate = (state) => state.viewState.currentDatePointerStart;\n\nexport const selectRangeType = (state) => state.viewState.selectedRangeType;\nexport const selectWeekStart = (state) => state.viewState.weekStart;\nexport const selectLocaleForWeekStart = (state) =>\n  state.viewState.weekStart === WEEK_START.SUNDAY ? 'en' : 'de';\n\nexport const selectCurrentDatePointers = (state) => {\n  const {\n    selectedRangeType,\n    currentDatePointerStart,\n    currentDatePointerEnd,\n  } = state.viewState;\n  const currentDatePointerStartDate = dayjs(currentDatePointerStart);\n\n  if (selectedRangeType === RANGE_TYPE.CUSTOM) {\n    return {\n      start: dayjs(currentDatePointerStart),\n      // The selected end day should be included in the calculation, so we\n      // need to add an extra day.\n      end: dayjs(currentDatePointerEnd).add(1, 'day'),\n    };\n  }\n\n  let rangeStart;\n  let rangeEnd;\n\n  if (selectedRangeType === RANGE_TYPE.DAY) {\n    rangeStart = currentDatePointerStartDate.startOf('day');\n    rangeEnd = rangeStart.add(1, 'day');\n  } else if (selectedRangeType === RANGE_TYPE.WEEK) {\n    rangeStart = currentDatePointerStartDate\n      .locale(selectLocaleForWeekStart(state))\n      .startOf('day')\n      .weekday(0);\n    rangeEnd = rangeStart.add(1, 'week');\n  } else if (selectedRangeType === RANGE_TYPE.MONTH) {\n    rangeStart = currentDatePointerStartDate.startOf('month');\n    rangeEnd = rangeStart.add(1, 'month');\n  } else if (selectedRangeType === RANGE_TYPE.YEAR) {\n    rangeStart = currentDatePointerStartDate.startOf('year');\n    rangeEnd = rangeStart.add(1, 'year');\n  } else if (selectedRangeType === RANGE_TYPE.TOTAL) {\n    rangeStart = dayjs('2000-01-01T10:00:00Z');\n    rangeEnd = dayjs('2040-01-01T10:00:00Z');\n  }\n\n  return {\n    start: rangeStart,\n    end: rangeEnd,\n  };\n};\n\nexport const selectEventsByRange = (state) => {\n  const events = selectCalendarEvents(state, selectSelectedCalendar(state));\n\n  if (!events) {\n    return null;\n  }\n\n  const { start: rangeStart, end: rangeEnd } = selectCurrentDatePointers(state);\n\n  return events\n    .filter(\n      ({ start, end }) =>\n        // Filter out all events that end before selected start date or start after\n        // selected end date.\n        !(new Date(end) < rangeStart || new Date(start) > rangeEnd)\n    )\n    .map(({ start, end, ...rest }) => ({\n      ...rest,\n      start: new Date(start) < rangeStart ? rangeStart.toJSON() : start,\n      end: new Date(end) > rangeEnd ? rangeEnd.toJSON() : end,\n    }));\n};\n\nexport const selectHours = (state) => {\n  const events = selectEventsByRange(state);\n\n  if (!events) {\n    return null;\n  }\n\n  let hours = 0;\n\n  events.forEach(({ start, end }) => {\n    hours += (new Date(end) - new Date(start)) / 1000 / 60 / 60;\n  });\n\n  return roundHours(hours);\n};\n\nexport const selectNumberOfEvents = (state) =>\n  selectEventsByRange(state)?.length || 0;\n\nconst computeHoursInRange = (events, start, end) => {\n  let hours = 0;\n  events.forEach(({ start: evStart, end: evEnd }) => {\n    const evStartDate = new Date(evStart);\n    const evEndDate = new Date(evEnd);\n    if (evEndDate <= start || evStartDate >= end) return;\n    const clippedStart = evStartDate < start ? start : evStartDate;\n    const clippedEnd = evEndDate > end ? end : evEndDate;\n    hours += (clippedEnd - clippedStart) / 1000 / 60 / 60;\n  });\n  return roundHours(hours);\n};\n\nexport const selectMonthlyGraphData = (state) => {\n  const events = selectCalendarEvents(state, selectSelectedCalendar(state));\n  if (!events) return null;\n\n  const year = dayjs(state.viewState.currentDatePointerStart).year();\n\n  return Array.from({ length: 12 }, (_, month) => {\n    const start = dayjs(`${year}-${String(month + 1).padStart(2, '0')}-01`)\n      .startOf('month')\n      .toDate();\n    const end = dayjs(`${year}-${String(month + 1).padStart(2, '0')}-01`)\n      .endOf('month')\n      .add(1, 'millisecond')\n      .toDate();\n    return {\n      label: dayjs(`${year}-${String(month + 1).padStart(2, '0')}-01`).format(\n        'MMM'\n      ),\n      hours: computeHoursInRange(events, start, end),\n    };\n  });\n};\n\nexport const selectYearlyGraphData = (state) => {\n  const events = selectCalendarEvents(state, selectSelectedCalendar(state));\n  if (!events) return null;\n\n  const currentYear = dayjs().year();\n  const years = Array.from({ length: 5 }, (_, i) => currentYear - 4 + i);\n\n  return years.map((year) => {\n    const start = dayjs(`${year}-01-01`).startOf('year').toDate();\n    const end = dayjs(`${year}-12-31`).endOf('year').add(1, 'millisecond').toDate();\n    return {\n      label: String(year),\n      hours: computeHoursInRange(events, start, end),\n    };\n  });\n};\n\nexport const selectAllCalendarsMonthlyData = (state) => {\n  const eventsMap = selectAllCalendarEventsMap(state);\n  const currentYear = dayjs().year();\n\n  const result = {};\n  Object.keys(eventsMap).forEach((calendarId) => {\n    const events = eventsMap[calendarId];\n    if (!events) return;\n    result[calendarId] = Array.from({ length: 12 }, (_, month) => {\n      const d = dayjs(`${currentYear}-${String(month + 1).padStart(2, '0')}-01`);\n      return {\n        label: d.format('MMM'),\n        hours: computeHoursInRange(\n          events,\n          d.startOf('month').toDate(),\n          d.endOf('month').add(1, 'millisecond').toDate()\n        ),\n      };\n    });\n  });\n  return result;\n};\n\nexport const selectAllCalendarsYearlyData = (state) => {\n  const eventsMap = selectAllCalendarEventsMap(state);\n  const currentYear = dayjs().year();\n  const years = Array.from({ length: 5 }, (_, i) => currentYear - 4 + i);\n\n  const result = {};\n  Object.keys(eventsMap).forEach((calendarId) => {\n    const events = eventsMap[calendarId];\n    if (!events) return;\n    result[calendarId] = years.map((year) => ({\n      label: String(year),\n      hours: computeHoursInRange(\n        events,\n        dayjs(`${year}-01-01`).startOf('year').toDate(),\n        dayjs(`${year}-12-31`).endOf('year').add(1, 'millisecond').toDate()\n      ),\n    }));\n  });\n  return result;\n};\n\nexport const selectAllCalendarsWeeklyData = (state) => {\n  const eventsMap = selectAllCalendarEventsMap(state);\n  const currentYear = dayjs().year();\n  // Determine number of ISO weeks in the current year\n  const weeksInYear = dayjs(`${currentYear}-12-28`).isoWeek();\n\n  const result = {};\n  Object.keys(eventsMap).forEach((calendarId) => {\n    const events = eventsMap[calendarId];\n    if (!events) return;\n    result[calendarId] = Array.from({ length: weeksInYear }, (_, i) => {\n      const weekNum = i + 1;\n      const weekStart = dayjs()\n        .year(currentYear)\n        .isoWeek(weekNum)\n        .startOf('isoWeek')\n        .toDate();\n      const weekEnd = dayjs()\n        .year(currentYear)\n        .isoWeek(weekNum)\n        .endOf('isoWeek')\n        .add(1, 'millisecond')\n        .toDate();\n      return {\n        label: `W${weekNum}`,\n        hours: computeHoursInRange(events, weekStart, weekEnd),\n      };\n    });\n  });\n  return result;\n};\n\nexport const setSelectedCalendar = ({ calendarId }) => (dispatch, getState) => {\n  dispatch(setSelectedCalendarId(calendarId));\n  updateConfig({ selectedCalendarId: calendarId });\n  const calendarEvents = selectCalendarEvents(getState(), calendarId);\n  if (!calendarEvents) {\n    dispatch(loadCalendarEvents({ calendarId }));\n  }\n};\n\nexport const changeRangeType = ({ range }) => (dispatch, getState) => {\n  if (range === RANGE_TYPE.CUSTOM) {\n    const { start, end } = selectCurrentDatePointers(getState());\n    // We need to subtract a day here, because a day was added to `end`\n    // in order to have the selected end day in the calculation.\n    const correctedEnd = end.subtract(1, 'day');\n    dispatch(setStart(start.toJSON()));\n    dispatch(setEnd(correctedEnd.toJSON()));\n    updateConfig({ start: start.toJSON(), end: correctedEnd.toJSON() });\n  }\n  dispatch(setRangeType(range));\n  updateConfig({ selectedRangeType: range });\n};\n\nexport const changeWeekStart = (weekStart) => (dispatch) => {\n  dispatch(setWeekStart(weekStart));\n  updateConfig({ weekStart });\n};\n\nexport const changeStart = (start) => (dispatch) => {\n  dispatch(setStart(start));\n  updateConfig({ start });\n};\n\nexport const changeEnd = (end) => (dispatch) => {\n  dispatch(setEnd(end));\n  updateConfig({ end });\n};\n\nexport default viewState.reducer;\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { selectCalendars } from '../stores/calendars';\nimport {\n  selectAllCalendarsMonthlyData,\n  selectAllCalendarsYearlyData,\n  selectAllCalendarsWeeklyData,\n} from '../stores/viewState';\n\nimport styles from './MultiCalendarGraph.module.css';\n\nconst CHART_TYPE = {\n  STACKED: 'stacked',\n  GROUPED: 'grouped',\n  LINE: 'line',\n  PIE: 'pie',\n};\n\nconst TIME_RANGE = {\n  WEEKLY: 'weekly',\n  MONTHLY: 'monthly',\n  YEARLY: 'yearly',\n};\n\nconst BAR_CHART_HEIGHT = 240;\nconst PADDING = { top: 28, right: 16, bottom: 40, left: 48 };\nconst Y_TICKS = 4;\n\nconst chartHeight = BAR_CHART_HEIGHT - PADDING.top - PADDING.bottom;\n\nfunction niceMax(rawMax) {\n  if (!rawMax || rawMax === 0) return Y_TICKS;\n  return Math.ceil(rawMax / Y_TICKS) * Y_TICKS;\n}\n\nfunction pickData(timeRange, weeklyData, monthlyData, yearlyData) {\n  if (timeRange === TIME_RANGE.WEEKLY) return weeklyData;\n  if (timeRange === TIME_RANGE.MONTHLY) return monthlyData;\n  return yearlyData;\n}\n\n// Compute pie arc path\nfunction pieSlicePath(cx, cy, r, startAngle, endAngle, innerR) {\n  const toRad = (deg) => (deg * Math.PI) / 180;\n  const x1 = cx + r * Math.cos(toRad(startAngle));\n  const y1 = cy + r * Math.sin(toRad(startAngle));\n  const x2 = cx + r * Math.cos(toRad(endAngle));\n  const y2 = cy + r * Math.sin(toRad(endAngle));\n  const ix1 = cx + innerR * Math.cos(toRad(endAngle));\n  const iy1 = cy + innerR * Math.sin(toRad(endAngle));\n  const ix2 = cx + innerR * Math.cos(toRad(startAngle));\n  const iy2 = cy + innerR * Math.sin(toRad(startAngle));\n  const largeArc = endAngle - startAngle > 180 ? 1 : 0;\n  return [\n    `M ${x1} ${y1}`,\n    `A ${r} ${r} 0 ${largeArc} 1 ${x2} ${y2}`,\n    `L ${ix1} ${iy1}`,\n    `A ${innerR} ${innerR} 0 ${largeArc} 0 ${ix2} ${iy2}`,\n    'Z',\n  ].join(' ');\n}\n\nconst MultiCalendarGraph = () => {\n  const calendars = useSelector(selectCalendars);\n  const monthlyData = useSelector(selectAllCalendarsMonthlyData);\n  const yearlyData = useSelector(selectAllCalendarsYearlyData);\n  const weeklyData = useSelector(selectAllCalendarsWeeklyData);\n\n  const [checkedCalendars, setCheckedCalendars] = useState(new Set());\n  const [chartType, setChartType] = useState(CHART_TYPE.STACKED);\n  const [timeRange, setTimeRange] = useState(TIME_RANGE.MONTHLY);\n  const scrollRef = useRef(null);\n\n  // Initialize all calendars as checked when the list is first available\n  useEffect(() => {\n    if (calendars && checkedCalendars.size === 0) {\n      setCheckedCalendars(new Set(calendars.map((c) => c.id)));\n    }\n  }, [calendars, checkedCalendars.size]);\n\n  const toggleCalendar = (calendarId) => {\n    setCheckedCalendars((prev) => {\n      const next = new Set(prev);\n      if (next.has(calendarId)) {\n        next.delete(calendarId);\n      } else {\n        next.add(calendarId);\n      }\n      return next;\n    });\n  };\n\n  // Pick the right data set based on timeRange\n  const allData = pickData(timeRange, weeklyData, monthlyData, yearlyData);\n\n  // Active calendars = those that are checked AND have data loaded\n  const activeCalendars = (calendars || []).filter(\n    (c) => checkedCalendars.has(c.id) && allData[c.id]\n  );\n\n  // Get period labels from the first active calendar's data, or empty\n  const firstData = activeCalendars.length > 0 ? allData[activeCalendars[0].id] : [];\n  const periods = firstData || [];\n\n  // ---- Y-axis helpers ----\n  const getStackedMax = () => {\n    if (periods.length === 0) return Y_TICKS;\n    let max = 0;\n    periods.forEach((_, i) => {\n      const total = activeCalendars.reduce(\n        (sum, cal) => sum + (allData[cal.id]?.[i]?.hours || 0),\n        0\n      );\n      if (total > max) max = total;\n    });\n    return niceMax(max);\n  };\n\n  const getSingleMax = () => {\n    let max = 0;\n    activeCalendars.forEach((cal) => {\n      (allData[cal.id] || []).forEach(({ hours }) => {\n        if (hours > max) max = hours;\n      });\n    });\n    return niceMax(max);\n  };\n\n  const yMax =\n    chartType === CHART_TYPE.STACKED ? getStackedMax() : getSingleMax();\n  const yTicks = Array.from({ length: Y_TICKS + 1 }, (_, i) =>\n    Math.round((yMax / Y_TICKS) * i)\n  );\n\n  // ---- SVG dimensions ----\n  const isWeekly = timeRange === TIME_RANGE.WEEKLY;\n  const periodCount = periods.length || 1;\n\n  // For weekly: wider SVG inside scrollable container\n  const svgWidth = isWeekly\n    ? Math.max(560, periodCount * 22 + PADDING.left + PADDING.right)\n    : 560;\n  const chartWidth = svgWidth - PADDING.left - PADDING.right;\n\n  // Bar sizing\n  const barSlotWidth = chartWidth / Math.max(periodCount, 1);\n  const groupedBarWidth =\n    activeCalendars.length > 0\n      ? (barSlotWidth * 0.8) / activeCalendars.length\n      : barSlotWidth * 0.6;\n  const stackedBarWidth = barSlotWidth * 0.6;\n  const stackedBarOffset = barSlotWidth * 0.2;\n\n  // ---- Chart rendering functions ----\n\n  const renderYAxis = () =>\n    yTicks.map((tick) => {\n      const y = PADDING.top + chartHeight - (tick / yMax) * chartHeight;\n      return (\n        <g key={tick}>\n          <line\n            x1={PADDING.left}\n            y1={y}\n            x2={PADDING.left + chartWidth}\n            y2={y}\n            stroke=\"#e0e0e0\"\n            strokeWidth=\"1\"\n          />\n          <text\n            x={PADDING.left - 6}\n            y={y + 4}\n            textAnchor=\"end\"\n            className={styles.axisLabel}\n          >\n            {tick}h\n          </text>\n        </g>\n      );\n    });\n\n  const renderXAxis = () => (\n    <line\n      x1={PADDING.left}\n      y1={PADDING.top + chartHeight}\n      x2={PADDING.left + chartWidth}\n      y2={PADDING.top + chartHeight}\n      stroke=\"#ccc\"\n      strokeWidth=\"1\"\n    />\n  );\n\n  const renderXLabels = (skipEvery = 1) =>\n    periods.map((p, i) => {\n      if (i % skipEvery !== 0) return null;\n      const x = PADDING.left + i * barSlotWidth + barSlotWidth / 2;\n      return (\n        <text\n          key={p.label}\n          x={x}\n          y={PADDING.top + chartHeight + 16}\n          textAnchor=\"middle\"\n          className={styles.axisLabel}\n        >\n          {p.label}\n        </text>\n      );\n    });\n\n  const renderStackedBars = () => {\n    const skipEvery = isWeekly ? 4 : 1;\n    return (\n      <React.Fragment>\n        {renderYAxis()}\n        {renderXAxis()}\n        {renderXLabels(skipEvery)}\n        {periods.map((period, periodIdx) => {\n          const x =\n            PADDING.left + periodIdx * barSlotWidth + stackedBarOffset;\n          let yBottom = PADDING.top + chartHeight;\n\n          return (\n            <g key={period.label}>\n              {activeCalendars.map((cal) => {\n                const hours = allData[cal.id]?.[periodIdx]?.hours || 0;\n                if (hours === 0) return null;\n                const barH = (hours / yMax) * chartHeight;\n                const y = yBottom - barH;\n                yBottom = y;\n                return (\n                  <rect\n                    key={cal.id}\n                    x={x}\n                    y={y}\n                    width={stackedBarWidth}\n                    height={barH}\n                    fill={cal.color}\n                    rx=\"2\"\n                    className={styles.bar}\n                  >\n                    <title>{`${cal.label} — ${period.label}: ${hours}h`}</title>\n                  </rect>\n                );\n              })}\n            </g>\n          );\n        })}\n      </React.Fragment>\n    );\n  };\n\n  const renderGroupedBars = () => {\n    const skipEvery = isWeekly ? 4 : 1;\n    return (\n      <React.Fragment>\n        {renderYAxis()}\n        {renderXAxis()}\n        {renderXLabels(skipEvery)}\n        {periods.map((period, periodIdx) => (\n          <g key={period.label}>\n            {activeCalendars.map((cal, calIdx) => {\n              const hours = allData[cal.id]?.[periodIdx]?.hours || 0;\n              const barH = Math.max((hours / yMax) * chartHeight, hours > 0 ? 1 : 0);\n              const x =\n                PADDING.left +\n                periodIdx * barSlotWidth +\n                barSlotWidth * 0.1 +\n                calIdx * groupedBarWidth;\n              const y = PADDING.top + chartHeight - barH;\n              return (\n                <rect\n                  key={cal.id}\n                  x={x}\n                  y={y}\n                  width={Math.max(groupedBarWidth - 1, 1)}\n                  height={barH}\n                  fill={cal.color}\n                  rx=\"1\"\n                  className={styles.bar}\n                >\n                  <title>{`${cal.label} — ${period.label}: ${hours}h`}</title>\n                </rect>\n              );\n            })}\n          </g>\n        ))}\n      </React.Fragment>\n    );\n  };\n\n  const renderLineChart = () => {\n    const skipEvery = isWeekly ? 4 : 1;\n    return (\n      <React.Fragment>\n        {renderYAxis()}\n        {renderXAxis()}\n        {renderXLabels(skipEvery)}\n        {activeCalendars.map((cal) => {\n          const calData = allData[cal.id] || [];\n          const points = calData\n            .map((d, i) => {\n              const x = PADDING.left + i * barSlotWidth + barSlotWidth / 2;\n              const y =\n                PADDING.top + chartHeight - (d.hours / yMax) * chartHeight;\n              return `${x},${y}`;\n            })\n            .join(' ');\n\n          return (\n            <g key={cal.id}>\n              <polyline\n                points={points}\n                fill=\"none\"\n                stroke={cal.color}\n                strokeWidth=\"2\"\n                strokeLinejoin=\"round\"\n                strokeLinecap=\"round\"\n                className={styles.line}\n              />\n              {calData.map((d) => {\n                if (d.hours === 0) return null;\n                const x = PADDING.left + calData.indexOf(d) * barSlotWidth + barSlotWidth / 2;\n                const y =\n                  PADDING.top + chartHeight - (d.hours / yMax) * chartHeight;\n                return (\n                  <circle\n                    key={d.label}\n                    cx={x}\n                    cy={y}\n                    r=\"3\"\n                    fill={cal.color}\n                    className={styles.dot}\n                  >\n                    <title>{`${cal.label} — ${d.label}: ${d.hours}h`}</title>\n                  </circle>\n                );\n              })}\n            </g>\n          );\n        })}\n      </React.Fragment>\n    );\n  };\n\n  const renderPieChart = () => {\n    // Sum total hours per calendar across all periods\n    const totals = activeCalendars.map((cal) => {\n      const total = (allData[cal.id] || []).reduce(\n        (sum, d) => sum + d.hours,\n        0\n      );\n      return { ...cal, total };\n    });\n    const grandTotal = totals.reduce((sum, c) => sum + c.total, 0);\n\n    if (grandTotal === 0) {\n      return (\n        <text x=\"280\" y=\"120\" textAnchor=\"middle\" className={styles.axisLabel}>\n          No data\n        </text>\n      );\n    }\n\n    const cx = 180;\n    const cy = 110;\n    const r = 90;\n    const innerR = 48;\n\n    let currentAngle = -90;\n    const slices = totals\n      .filter((c) => c.total > 0)\n      .map((cal) => {\n        const angle = (cal.total / grandTotal) * 360;\n        const slice = {\n          ...cal,\n          startAngle: currentAngle,\n          endAngle: currentAngle + angle,\n          pct: ((cal.total / grandTotal) * 100).toFixed(1),\n        };\n        currentAngle += angle;\n        return slice;\n      });\n\n    return (\n      <React.Fragment>\n        {slices.map((s) => (\n          <path\n            key={s.id}\n            d={pieSlicePath(cx, cy, r, s.startAngle, s.endAngle, innerR)}\n            fill={s.color}\n            stroke=\"#fff\"\n            strokeWidth=\"2\"\n            className={styles.bar}\n          >\n            <title>{`${s.label}: ${s.total.toFixed(1)}h (${s.pct}%)`}</title>\n          </path>\n        ))}\n        {/* Center label */}\n        <text x={cx} y={cy - 6} textAnchor=\"middle\" className={styles.pieCenter}>\n          {grandTotal.toFixed(0)}h\n        </text>\n        <text x={cx} y={cy + 12} textAnchor=\"middle\" className={styles.pieCenterSub}>\n          total\n        </text>\n        {/* Legend */}\n        {slices.map((s, i) => {\n          const lx = 290;\n          const ly = 40 + i * 22;\n          return (\n            <g key={s.id}>\n              <rect x={lx} y={ly} width={12} height={12} fill={s.color} rx=\"2\" />\n              <text x={lx + 18} y={ly + 10} className={styles.legendLabel}>\n                {s.label}\n              </text>\n              <text x={lx + 230} y={ly + 10} textAnchor=\"end\" className={styles.legendHours}>\n                {s.total.toFixed(1)}h ({s.pct}%)\n              </text>\n            </g>\n          );\n        })}\n      </React.Fragment>\n    );\n  };\n\n  const isPie = chartType === CHART_TYPE.PIE;\n  const pieSvgWidth = 540;\n  const pieSvgHeight = Math.max(240, activeCalendars.length * 22 + 80);\n\n  const renderChart = () => {\n    if (activeCalendars.length === 0) {\n      return (\n        <div className={styles.empty}>\n          Select at least one calendar to show the chart.\n        </div>\n      );\n    }\n    if (isPie) {\n      return (\n        <svg\n          className={styles.chart}\n          viewBox={`0 0 ${pieSvgWidth} ${pieSvgHeight}`}\n          aria-label=\"Pie chart: time per calendar\"\n        >\n          {renderPieChart()}\n        </svg>\n      );\n    }\n    return (\n      <div\n        className={`${styles.chartScroll} ${isWeekly ? styles.scrollable : ''}`}\n        ref={scrollRef}\n      >\n        <svg\n          className={styles.chart}\n          viewBox={`0 0 ${svgWidth} ${BAR_CHART_HEIGHT}`}\n          style={isWeekly ? { minWidth: svgWidth } : {}}\n          aria-label={`${chartType} ${timeRange} hours chart`}\n        >\n          {chartType === CHART_TYPE.STACKED && renderStackedBars()}\n          {chartType === CHART_TYPE.GROUPED && renderGroupedBars()}\n          {chartType === CHART_TYPE.LINE && renderLineChart()}\n        </svg>\n      </div>\n    );\n  };\n\n  return (\n    <div className={styles.container}>\n      {/* Calendar checkboxes */}\n      <div className={styles.calendarList}>\n        {(calendars || []).map((cal) => (\n          <label key={cal.id} className={styles.calendarItem}>\n            <input\n              type=\"checkbox\"\n              checked={checkedCalendars.has(cal.id)}\n              onChange={() => toggleCalendar(cal.id)}\n              className={styles.checkbox}\n            />\n            <span\n              className={styles.colorDot}\n              style={{ background: cal.color }}\n            />\n            <span className={styles.calendarName}>{cal.label}</span>\n            {!allData[cal.id] && (\n              <span className={styles.loadingBadge}>loading…</span>\n            )}\n          </label>\n        ))}\n      </div>\n\n      {/* Controls row */}\n      <div className={styles.controls}>\n        <div className={styles.controlGroup}>\n          <span className={styles.controlLabel}>Chart</span>\n          <div className={styles.toggle}>\n            {[\n              { key: CHART_TYPE.STACKED, label: 'Stacked' },\n              { key: CHART_TYPE.GROUPED, label: 'Grouped' },\n              { key: CHART_TYPE.LINE, label: 'Line' },\n              { key: CHART_TYPE.PIE, label: 'Pie' },\n            ].map(({ key, label }) => (\n              <button\n                key={key}\n                type=\"button\"\n                className={`${styles.toggleBtn} ${chartType === key ? styles.active : ''}`}\n                onClick={() => setChartType(key)}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div className={styles.controlGroup}>\n          <span className={styles.controlLabel}>Period</span>\n          <div className={styles.toggle}>\n            {[\n              { key: TIME_RANGE.WEEKLY, label: 'Weekly' },\n              { key: TIME_RANGE.MONTHLY, label: 'Monthly' },\n              { key: TIME_RANGE.YEARLY, label: 'Yearly' },\n            ].map(({ key, label }) => (\n              <button\n                key={key}\n                type=\"button\"\n                className={`${styles.toggleBtn} ${timeRange === key ? styles.active : ''}`}\n                onClick={() => setTimeRange(key)}\n                disabled={isPie}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Chart */}\n      {renderChart()}\n    </div>\n  );\n};\n\nexport default MultiCalendarGraph;\n","import React, { useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport MultiCalendarGraph from './features/MultiCalendarGraph';\nimport { selectIsEventsLoading } from './stores/calendarEvents';\nimport { loadCalendars, selectCalendars } from './stores/calendars';\n\nimport styles from './Interface.module.css';\n\nconst Interface = () => {\n  const dispatch = useDispatch();\n\n  const calendars = useSelector(selectCalendars);\n  const eventsLoading = useSelector(selectIsEventsLoading);\n\n  useEffect(() => {\n    if (!calendars) {\n      dispatch(loadCalendars());\n    }\n  });\n\n  if (!calendars) {\n    return <div className={styles.interface}>Loading calendars…</div>;\n  }\n\n  return (\n    <div className={styles.interface}>\n      {eventsLoading && (\n        <div className={styles.loadingBar}>Loading calendar events…</div>\n      )}\n      <MultiCalendarGraph />\n    </div>\n  );\n};\n\nexport default Interface;\n","import React, { useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport { decode } from 'qss';\n\nimport { selectHasToken } from './stores/authentication';\n\nimport AuthScreen from './AuthScreen';\nimport Interface from './Interface';\n\nimport styles from './App.module.css';\n\nconst App = () => {\n  const hasToken = useSelector(selectHasToken);\n\n  useEffect(() => {\n    const hashParams = decode(window.location?.hash?.slice(1) ?? '');\n\n    if (hashParams.access_token) {\n      sessionStorage.setItem('accessToken', hashParams.access_token);\n      window.location = window.location.pathname.replace(/\\/$/, '') || '/';\n    }\n  }, []);\n\n  return (\n    <div className={styles.appWrapper}>\n      <div className={styles.app}>\n        <div className={styles.sticky}>\n          <div className={styles.content}>\n            <h1 className={styles.headline}>\n              Google Calendar Hours Calculator\n            </h1>\n            {!hasToken && <AuthScreen />}\n            {hasToken && <Interface />}\n          </div>\n          <footer className={styles.footer}>\n            <p>\n              <span>© 2011 - 2023. This app is open source. </span>\n              <a\n                href=\"https://github.com/aronwoost/google-calendar-hours\"\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                Check it on GitHub\n              </a>\n              <span>.</span>\n            </p>\n          </footer>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import { configureStore } from '@reduxjs/toolkit';\nimport dayjs from 'dayjs';\nimport weekday from 'dayjs/plugin/weekday';\n\nimport authentication from './authentication';\nimport calendars from './calendars';\nimport viewState from './viewState';\nimport calendarEvents from './calendarEvents';\nimport { getConfig } from './storage';\nimport { RANGE_TYPE, WEEK_START } from '../constants';\n\ndayjs.extend(weekday);\n\nconst getAccessToken = () => {\n  try {\n    return sessionStorage.getItem('accessToken');\n  } catch (e) {\n    // don't handle\n  }\n\n  return null;\n};\n\nconst getViewState = () => {\n  const config = getConfig() ?? {};\n  return {\n    selectedRangeType: config.selectedRangeType ?? RANGE_TYPE.MONTH,\n    currentDatePointerStart:\n      config.selectedRangeType === RANGE_TYPE.CUSTOM\n        ? config.start\n        : dayjs().startOf('day').toJSON(),\n    currentDatePointerEnd: config.end,\n    weekStart: config.weekStart ?? WEEK_START.MONDAY,\n  };\n};\n\nconst store = () =>\n  configureStore({\n    reducer: {\n      authentication,\n      calendars,\n      viewState,\n      calendarEvents,\n    },\n    preloadedState: {\n      authentication: { accessToken: getAccessToken() },\n      viewState: getViewState(),\n    },\n  });\n\nexport default store;\n","export const updateConfig = (rest) => {\n  let existingConfig;\n  try {\n    existingConfig = JSON.parse(window.localStorage.getItem('config'));\n  } catch (err) {\n    // don't handle\n  }\n\n  const updatedConfig = {\n    ...existingConfig,\n    ...rest,\n  };\n\n  window.localStorage.setItem('config', JSON.stringify(updatedConfig));\n};\n\nexport const getConfig = () => {\n  try {\n    return JSON.parse(window.localStorage.getItem('config'));\n  } catch (err) {\n    // don't handle\n  }\n  return null;\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport './index.css';\nimport App from './App';\nimport store from './stores';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store()}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"appWrapper\":\"App_appWrapper__3rnam\",\"app\":\"App_app__1kX79\",\"sticky\":\"App_sticky__1Ko52\",\"content\":\"App_content__3La4L\",\"headline\":\"App_headline__1z0fO\",\"footer\":\"App_footer__29Fsv\"};"],"sourceRoot":""}